!function(I){var g={};function t(C){if(g[C])return g[C].exports;var l=g[C]={i:C,l:!1,exports:{}};return I[C].call(l.exports,l,l.exports,t),l.l=!0,l.exports}t.m=I,t.c=g,t.d=function(I,g,C){t.o(I,g)||Object.defineProperty(I,g,{enumerable:!0,get:C})},t.r=function(I){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(I,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(I,"__esModule",{value:!0})},t.t=function(I,g){if(1&g&&(I=t(I)),8&g)return I;if(4&g&&"object"==typeof I&&I&&I.__esModule)return I;var C=Object.create(null);if(t.r(C),Object.defineProperty(C,"default",{enumerable:!0,value:I}),2&g&&"string"!=typeof I)for(var l in I)t.d(C,l,function(g){return I[g]}.bind(null,l));return C},t.n=function(I){var g=I&&I.__esModule?function(){return I.default}:function(){return I};return t.d(g,"a",g),g},t.o=function(I,g){return Object.prototype.hasOwnProperty.call(I,g)},t.p="",t(t.s=0)}([function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n\n// CONCATENATED MODULE: ./src/model/Monster.js\nclass Monster{\r\n    // MonsterData consists of element, name, arms, type_arms, legs, eyes, skintype, ability to fly, ability to swim, colour ,map, x coordinate, y coordinate\r\n    constructor(name, element, arms, typearms, legs, eyes, furtype, fly, swim, colour, map, x, y){\r\n        this.name = name;\r\n        this.element = element;\r\n        this.arms = arms;\r\n        this.typearms = typearms;\r\n        this.legs = legs;\r\n        this.eyes = eyes;\r\n        this.furtype = furtype;\r\n        this.fly = fly;\r\n        this.swim = swim;\r\n        this.colour = colour;\r\n        this.map = map;\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n}\r\n\r\n// class fireMonster extends Monster{\r\n\r\n// }\r\n// class waterfireMonster extends Monster{\r\n    \r\n// }\r\n// class earthMonster extends Monster{\r\n    \r\n// }\r\n// class windMonster extends Monster{\r\n    \r\n// }\n// CONCATENATED MODULE: ./src/model/MonsterService.js\n\r\n\r\n\r\nclass MonsterService_MonsterService\r\n{\r\n    constructor(){\r\n        this.monsters = [\r\n            new Monster("fire", "Marijn", 2, "tentacles", 2, 4, "scales", false, false, "orange", 0, 1, 1)\r\n        ]\r\n    }\r\n\r\n    getMonsters()\r\n    {\r\n        return this.monsters;\r\n    }\r\n\r\n    saveMonster(name, element, arms, typearms, legs, eyes, furtype, fly, swim, colour, map, x, y){\r\n        let newMonster = new Monster(name, element, arms, typearms, legs, eyes, furtype, fly, swim, colour, map, x, y);\r\n        this.monsters.push(newMonster);\r\n    }\r\n\r\n    getLastMonster() {\r\n        return this.monsters[this.monsters.length -1];\r\n    }\r\n}\r\n\n// CONCATENATED MODULE: ./src/view/CreateMonsterView.js\nclass CreateMonsterView {\r\n\r\n  constructor(controller) {\r\n    this.controller = controller;\r\n\r\n    this.template = document.getElementById("create_monster");\r\n\r\n    this.radio_fire = document.getElementById("element_fire");\r\n    this.radio_water = document.getElementById("element_water");\r\n    this.radio_earth = document.getElementById("element_earth");\r\n    this.radio_wind = document.getElementById("element_wind");\r\n    this.remove = document.getElementById("remove");\r\n\r\n    this.setElementEvents();\r\n    // this.setEvents();\r\n  }\r\n\r\n  updateForm(controller) {\r\n    this.monsterform = document.getElementById("monster_form");\r\n    let created = document.getElementById("created");\r\n\r\n    this.monsterform.addEventListener("submit", function(e) {\r\n      e.preventDefault();\r\n\r\n      if (created.hasChildNodes()) {\r\n        while (created.firstChild) {\r\n          created.removeChild(created.firstChild);\r\n        }\r\n      }\r\n      this.img = document.createElement("img");\r\n      this.img.setAttribute("class", "created");\r\n\r\n      let src = "";\r\n\r\n      console.log(this.element.value)\r\n\r\n      switch (this.element.value) {\r\n        case "fire":\r\n          src = "../src/Resources/orangemonster.png";\r\n          break;\r\n        case "water":\r\n          src = "../src/Resources/bluemonster.png";\r\n          break;\r\n        case "earth":\r\n          src = "../src/Resources/brownmonster.png";\r\n          break;\r\n        case "wind":\r\n          src = "../src/Resources/whitemonster.png";\r\n          break;\r\n\r\n        default:\r\n          break;\r\n      }\r\n      this.img.src = src;\r\n      this.img.draggable = true;\r\n      this.img.setAttribute(\'id\', \'-1x-1\');\r\n      this.img.addEventListener("dragstart", function(e) {\r\n        e.dataTransfer.setData("Text", e.target.id);\r\n      });\r\n      created.appendChild(this.img);\r\n\r\n      let name = document.getElementById("name").value;\r\n      let element = document.getElementById("element").value;\r\n      let arms = document.getElementById("arms").value;\r\n      let typearms = document.getElementById("type_arms").value;\r\n      let legs = document.getElementById("legs").value;\r\n      let eyes = document.getElementById("eyes").value;\r\n      let furtype = document.getElementById("furtype").value;\r\n      let fly = document.getElementById("fly").value;\r\n      let swim = document.getElementById("swim").value;\r\n      let colour = document.getElementById("colour").value;\r\n      \r\n      controller.addMonster(name, element, arms, typearms, legs, eyes, furtype, fly, swim, colour, null, null, null);\r\n\r\n    });\r\n  }\r\n\r\n  setElementEvents() {\r\n    this.radio_fire.addEventListener("click", function() {\r\n          if (this.checked) {\r\n            let form = document.getElementById("monster_form");\r\n            // TODO: Remove previous form\r\n\r\n            let fieldset = document.createElement("fieldset");\r\n            let namelabel = document.createElement("label");\r\n            namelabel.innerHTML = "Name:";\r\n            let nameinput = document.createElement("input");\r\n            nameinput.setAttribute("id", "name");\r\n            nameinput.setAttribute("name", "name");\r\n\r\n            fieldset.appendChild(namelabel);\r\n            fieldset.appendChild(nameinput);\r\n\r\n            form.appendChild(fieldset);\r\n\r\n            let element = document.createElement("input");\r\n            element.setAttribute("id", "element");\r\n            element.setAttribute("value", "fire");\r\n            element.hidden = true;\r\n\r\n            form.appendChild(element);\r\n            \r\n            let fieldset2 = document.createElement("fieldset");\r\n            let armslabel = document.createElement("label");\r\n            armslabel.innerHTML = "Arms:";\r\n            let select = document.createElement("select");\r\n            select.setAttribute("id", "arms");\r\n            for(let i = 1; i < 7; i++) {\r\n              let option = document.createElement("option");\r\n              option.setAttribute("value", `${i}`);\r\n              option.innerHTML = i;\r\n              select.appendChild(option);\r\n            }\r\n\r\n            fieldset2.appendChild(armslabel);\r\n            fieldset2.appendChild(select);\r\n\r\n            form.appendChild(fieldset2);\r\n\r\n            let fieldset3 = document.createElement("fieldset");\r\n            let typearmslabel = document.createElement("label");\r\n            typearmslabel.innerHTML = "Type arms:"\r\n\r\n            let typearmsselect = document.createElement("select");\r\n            typearmsselect.setAttribute("id", "type_arms");\r\n            let option1 = document.createElement("option");\r\n            option1.setAttribute("value", "tentacles");\r\n            option1.innerHTML = "Tentacles";\r\n            let option2 = document.createElement("option");\r\n            option2.setAttribute("value", "claws");\r\n            option2.innerHTML = "Claws";\r\n            let option3 = document.createElement("option");\r\n            option3.setAttribute("value", "claw-wings");\r\n            option3.innerHTML = "Claw-wings";\r\n\r\n            typearmsselect.appendChild(option1);\r\n            typearmsselect.appendChild(option2);\r\n            typearmsselect.appendChild(option3);\r\n\r\n            fieldset3.appendChild(typearmsselect);\r\n\r\n            form.appendChild(typearmslabel);\r\n            form.appendChild(fieldset3);\r\n\r\n            let fieldset4 = document.createElement("fieldset");\r\n            let legslabel = document.createElement("label");\r\n            legslabel.innerHTML = "Legs: 2";\r\n\r\n            let legsinput = document.createElement("input");\r\n            legsinput.setAttribute("id", "legs");\r\n            legsinput.setAttribute("value", "2");\r\n            legsinput.setAttribute("class", "hidden");\r\n\r\n            fieldset4.appendChild(legslabel);\r\n            fieldset4.appendChild(legsinput);\r\n            form.appendChild(fieldset4);\r\n\r\n            let fieldset9 = document.createElement("fieldset");\r\n            let eyeslabel = document.createElement("label");\r\n            eyeslabel.innerHTML = "Eyes:";\r\n            let select2 = document.createElement("select");\r\n            select2.setAttribute("id", "eyes");\r\n            for(let i = 1; i < 5; i++) {\r\n              let option = document.createElement("option");\r\n              option.setAttribute("value", `${i}`);\r\n              option.innerHTML = i;\r\n              select2.appendChild(option);\r\n            }\r\n\r\n            fieldset9.appendChild(eyeslabel);\r\n            fieldset9.appendChild(select2);\r\n\r\n            form.append(fieldset9);\r\n\r\n            let fieldset5 = document.createElement("fieldset");\r\n            let furtypelabel = document.createElement("label");\r\n            furtypelabel.innerHTML = "Fur type:";\r\n            let typefurselect = document.createElement("select");\r\n            typefurselect.setAttribute("id", "furtype");\r\n            let option11 = document.createElement("option");\r\n            option11.setAttribute("value", "scales");\r\n            option11.innerHTML = "Scales";\r\n            let option22 = document.createElement("option");\r\n            option22.setAttribute("value", "feathers");\r\n            option22.innerHTML = "Feathers";\r\n\r\n            typefurselect.appendChild(option11);\r\n            typefurselect.appendChild(option22);\r\n\r\n            fieldset5.appendChild(furtypelabel);\r\n            fieldset5.appendChild(typefurselect);\r\n            form.appendChild(fieldset5);\r\n\r\n            let fieldset6 = document.createElement("fieldset");\r\n            let flylabel = document.createElement("label");\r\n            flylabel.innerHTML = "Can fly: no";\r\n            let fly = document.createElement("input");\r\n            fly.setAttribute("id", "fly");\r\n            fly.setAttribute("value", "false");\r\n            fly.setAttribute("class", "hidden");\r\n\r\n            fieldset6.appendChild(flylabel);\r\n            fieldset6.appendChild(fly);\r\n\r\n            form.appendChild(fieldset6);\r\n\r\n            let fieldset7 = document.createElement("fieldset");\r\n            let swimlabel = document.createElement("label");\r\n            swimlabel.innerHTML = "Can swim: no";\r\n            let swim = document.createElement("input");\r\n            swim.setAttribute("id", "swim");\r\n            swim.setAttribute("value", "false");\r\n            swim.setAttribute("class", "hidden");\r\n\r\n            fieldset6.appendChild(swimlabel);\r\n            fieldset6.appendChild(swim);\r\n\r\n            form.appendChild(fieldset7);\r\n\r\n            let fieldset8 = document.createElement("fieldset");\r\n            let colourlabel = document.createElement("label");\r\n            colourlabel.innerHTML = "Colour:"\r\n\r\n            let colourselect = document.createElement("select");\r\n            colourselect.setAttribute("id", "colour");\r\n            let option111 = document.createElement("option");\r\n            option111.setAttribute("value", "red");\r\n            option111.innerHTML = "Red";\r\n            let option222 = document.createElement("option");\r\n            option222.setAttribute("value", "orange");\r\n            option222.innerHTML = "Orange";\r\n            let option333 = document.createElement("option");\r\n            option333.setAttribute("value", "brown");\r\n            option333.innerHTML = "Brown";\r\n\r\n            colourselect.appendChild(option111);\r\n            colourselect.appendChild(option222);\r\n            colourselect.appendChild(option333);\r\n\r\n            fieldset8.appendChild(colourselect);\r\n\r\n            form.appendChild(colourlabel);\r\n            form.appendChild(fieldset8);\r\n\r\n            let resetbutton = document.createElement("input");\r\n            resetbutton.setAttribute("type", "reset");\r\n            resetbutton.setAttribute("class", "nes-btn is-error");\r\n            resetbutton.setAttribute("value", "Cancel");\r\n\r\n            let submit = document.createElement("input");\r\n            submit.setAttribute("type", "submit");\r\n            submit.setAttribute("class", "nes-btn is-success");\r\n            submit.setAttribute("value", "Submit");\r\n\r\n            form.appendChild(resetbutton);\r\n            form.appendChild(submit);\r\n          }\r\n    });\r\n\r\n    this.radio_fire.addEventListener("click", this.updateForm(this.controller));\r\n  }\r\n\r\n  // setEvents() {\r\n  //   //events\r\n  //   this.radio_fire.addEventListener("click", function() {\r\n  //     if (this.checked) {\r\n  //       let firetemp = document.getElementById("fire_template");\r\n  //       firetemp.style.display = "block";\r\n  //       firetemp.childNodes[1].setAttribute("id", "monster_form");\r\n  //       document.getElementById("water_template").style.display = "none";\r\n  //       document\r\n  //         .getElementById("water_template")\r\n  //         .childNodes[1].removeAttribute("id");\r\n  //       document.getElementById("earth_template").style.display = "none";\r\n  //       document\r\n  //         .getElementById("earth_template")\r\n  //         .childNodes[1].removeAttribute("id");\r\n  //       document.getElementById("wind_template").style.display = "none";\r\n  //       document\r\n  //         .getElementById("wind_template")\r\n  //         .childNodes[1].removeAttribute("id");\r\n  //     }\r\n  //   });\r\n\r\n  //   this.radio_fire.addEventListener("click", this.updateForm(this.controller));\r\n\r\n  //   this.radio_water.addEventListener("click", function() {\r\n  //     let watertemp = document.getElementById("water_template");\r\n  //     watertemp.style.display = "block";\r\n  //     watertemp.childNodes[1].setAttribute("id", "monster_form");\r\n  //     document.getElementById("fire_template").style.display = "none";\r\n  //     document\r\n  //       .getElementById("fire_template")\r\n  //       .childNodes[1].removeAttribute("id");\r\n  //     document.getElementById("earth_template").style.display = "none";\r\n  //     document\r\n  //       .getElementById("earth_template")\r\n  //       .childNodes[1].removeAttribute("id");\r\n  //     document.getElementById("wind_template").style.display = "none";\r\n  //     document\r\n  //       .getElementById("wind_template")\r\n  //       .childNodes[1].removeAttribute("id");\r\n  //   });\r\n\r\n  //   this.radio_water.addEventListener("click", this.updateForm(this.controller));\r\n\r\n  //   this.radio_earth.addEventListener("click", function() {\r\n  //     let earthtemp = document.getElementById("earth_template");\r\n  //     earthtemp.style.display = "block";\r\n  //     earthtemp.childNodes[1].setAttribute("id", "monster_form");\r\n  //     document.getElementById("fire_template").style.display = "none";\r\n  //     document\r\n  //       .getElementById("fire_template")\r\n  //       .childNodes[1].removeAttribute("id");\r\n  //     document.getElementById("water_template").style.display = "none";\r\n  //     document\r\n  //       .getElementById("water_template")\r\n  //       .childNodes[1].removeAttribute("id");\r\n  //     document.getElementById("wind_template").style.display = "none";\r\n  //     document\r\n  //       .getElementById("wind_template")\r\n  //       .childNodes[1].removeAttribute("id");\r\n  //   });\r\n\r\n  //   this.radio_earth.addEventListener("click", this.updateForm(this.controller));\r\n\r\n  //   this.radio_wind.addEventListener("click", function() {\r\n  //     let windtemp = document.getElementById("wind_template");\r\n  //     windtemp.style.display = "block";\r\n  //     windtemp.childNodes[1].setAttribute("id", "monster_form");\r\n  //     document.getElementById("fire_template").style.display = "none";\r\n  //     document\r\n  //       .getElementById("fire_template")\r\n  //       .childNodes[1].removeAttribute("id");\r\n  //     document.getElementById("water_template").style.display = "none";\r\n  //     document\r\n  //       .getElementById("water_template")\r\n  //       .childNodes[1].removeAttribute("id");\r\n  //     document.getElementById("earth_template").style.display = "none";\r\n  //     document\r\n  //       .getElementById("earth_template")\r\n  //       .childNodes[1].removeAttribute("id");\r\n  //   });\r\n\r\n  //   this.radio_wind.addEventListener("click", this.updateForm(this.controller));\r\n  // }\r\n}\r\n\n// CONCATENATED MODULE: ./src/view/MapView.js\nclass MapView {\r\n  constructor(zoocontroller, weathercontroller) {\r\n    this.map = document.getElementById("map");\r\n    this.remove = document.getElementById("remove");\r\n\r\n    this.zoocontroller = zoocontroller;\r\n    this.weathercontroller = weathercontroller;\r\n\r\n    // Zoo width (zw) and zoo height (zh)\r\n\r\n    this.zw = 10;\r\n    this.zh = 10;\r\n\r\n    // Load buttons from index.html\r\n\r\n    let jungle = document.getElementById("jungle");\r\n    let desert = document.getElementById("desert");\r\n    let northpole = document.getElementById("northpole");\r\n\r\n    jungle.disabled = true;\r\n    jungle.setAttribute("class", "nes-btn is-disabled");\r\n\r\n    // ---------------------------------------------------------------------------------------------------------\r\n    // Buttons for switching between environments\r\n    // ---------------------------------------------------------------------------------------------------------\r\n\r\n    jungle.addEventListener("click", () => {\r\n      if (jungle.disabled != true) {\r\n        this.loadGrid(0);\r\n        jungle.disabled = true;\r\n        desert.disabled = false;\r\n        northpole.disabled = false;\r\n\r\n        jungle.setAttribute("class", "nes-btn is-disabled");\r\n        desert.setAttribute("class", "nes-btn is-warning");\r\n        northpole.setAttribute("class", "nes-btn");\r\n      }\r\n    });\r\n\r\n    desert.addEventListener("click", () => {\r\n      if (desert.disabled != true) {\r\n        this.loadGrid(2);\r\n        desert.disabled = true;\r\n        jungle.disabled = false;\r\n        northpole.disabled = false;\r\n\r\n        desert.setAttribute("class", "nes-btn is-disabled");\r\n        jungle.setAttribute("class", "nes-btn is-success");\r\n        northpole.setAttribute("class", "nes-btn");\r\n      }\r\n    });\r\n\r\n    northpole.addEventListener("click", () => {\r\n      if (northpole.disabled != true) {\r\n        this.loadGrid(1);\r\n        northpole.disabled = true;\r\n        desert.disabled = false;\r\n        jungle.disabled = false;\r\n\r\n        northpole.setAttribute("class", "nes-btn is-disabled");\r\n        jungle.setAttribute("class", "nes-btn is-success");\r\n        desert.setAttribute("class", "nes-btn is-warning");\r\n      }\r\n    });\r\n\r\n    // ---------------------------------------------------------------------------------------------------------\r\n\r\n    // Initialise the map from jungle\r\n    this.loadGrid(0);\r\n  }\r\n\r\n  loadGrid(terrain) {\r\n    // Terrain index: 0 is jungle, 1 is northpole, 3 is desert\r\n    this.terrain = terrain;\r\n    this.zoocontroller.loadGrid(this);\r\n  }\r\n\r\n  paintGrid(grid) {\r\n    this.grid = grid;\r\n    this.selected = this.grid[this.terrain].grid;\r\n    this.weathercontroller.updateWeather(\r\n      this.grid[this.terrain].reference_city\r\n    );\r\n    this.initRemove();\r\n    this.drawBoard();\r\n  }\r\n\r\n  drawBoard() {\r\n    let oldBoard = document.getElementById("grid");\r\n    if (oldBoard != null) {\r\n      oldBoard.remove();\r\n    }\r\n\r\n    this.table = document.createElement("table");\r\n    this.table.setAttribute("id", "grid");\r\n\r\n    for (let i = 0; i < this.zw; i++) {\r\n      this.tr = document.createElement("tr");\r\n      for (let y = 0; y < this.zh; y++) {\r\n        this.td = document.createElement("td");\r\n\r\n        // Drag and drop events\r\n        this.td.addEventListener("dragover", function(e) {\r\n          e.preventDefault();\r\n        });\r\n\r\n        this.td.addEventListener("dragenter", function(e) {\r\n          e.preventDefault();\r\n        });\r\n\r\n        let grid = this.grid;\r\n        let terrain = this.terrain;\r\n        let zoocontroller = this.zoocontroller;\r\n\r\n        this.td.addEventListener("drop", function(e) {\r\n          let data = e.dataTransfer.getData("Text");\r\n          let monster = document.getElementById(data);\r\n\r\n          if (monster != null) {\r\n            if (\r\n              !this.hasChildNodes() &&\r\n              monster.getAttribute("draggable") === "true"\r\n            ) {\r\n              let origin = monster.getAttribute("id").split("x");\r\n              let coordid = this.getAttribute("id").split("-");\r\n\r\n              zoocontroller.addMonsterToGrid(\r\n                grid,\r\n                terrain,\r\n                coordid[0],\r\n                coordid[1]\r\n              );\r\n\r\n              if (monster.getAttribute("id") !== "-1x-1") {\r\n                zoocontroller.deleteMonsterFromGrid(\r\n                  grid,\r\n                  terrain,\r\n                  origin[0],\r\n                  origin[1]\r\n                );\r\n              }\r\n\r\n              monster.setAttribute("id", coordid[0] + "x" + coordid[1]);\r\n              this.append(monster);\r\n            }\r\n          }\r\n        });\r\n\r\n        this.td.setAttribute("id", i + "-" + y);\r\n\r\n        if (typeof this.selected[i].Columns[y] === "object") {\r\n          let monster = this.selected[i].Columns[y];\r\n          this.img = document.createElement("img");\r\n          this.img.setAttribute("class", "monster");\r\n\r\n          //Every monster gets an id based on their coordinates\r\n          this.img.setAttribute("id", i + "x" + y);\r\n\r\n          switch (monster.element) {\r\n            case "fire":\r\n              this.img.src = "../src/Resources/orangemonster.png";\r\n              break;\r\n            case "water":\r\n              this.img.src = "../src/Resources/bluemonster.png";\r\n              break;\r\n            case "earth":\r\n              this.img.src = "../src/Resources/brownmonster.png";\r\n              break;\r\n            case "wind":\r\n              this.img.src = "../src/Resources/whitemonster.png";\r\n              break;\r\n\r\n            default:\r\n              alert("Warning: could not find resource for monster");\r\n              break;\r\n          }\r\n\r\n          this.img.draggable = true;\r\n          this.img.addEventListener("dragstart", function(e) {\r\n            e.dataTransfer.setData("Text", e.target.id);\r\n          });\r\n          this.td.appendChild(this.img);\r\n        }\r\n\r\n        if (this.selected[i].Columns[y] == 1) {\r\n          this.img = document.createElement("img");\r\n          this.img.setAttribute("class", "stone");\r\n\r\n          //Every monster gets an id based on their coordinates\r\n          this.img.setAttribute("id", i + "x" + y);\r\n\r\n          switch (terrain) {\r\n            // Jungle\r\n            case 0:\r\n              this.img.src = "../src/Resources/junglerock.png";\r\n              document.getElementById("map").style.backgroundColor = "#289150";\r\n              break;\r\n\r\n            // Nortpole\r\n            case 1:\r\n              this.img.src = "../src/Resources/icechunk.png";\r\n              document.getElementById("map").style.backgroundColor = "#D8FFFF";\r\n              break;\r\n\r\n            // Desert\r\n            case 2:\r\n              this.img.src = "../src/Resources/cactus.png";\r\n              document.getElementById("map").style.backgroundColor = "#EDC9AF";\r\n              break;\r\n\r\n            default:\r\n              break;\r\n          }\r\n          this.td.appendChild(this.img);\r\n        }\r\n        this.tr.appendChild(this.td);\r\n      }\r\n      this.table.appendChild(this.tr);\r\n    }\r\n    this.map.appendChild(this.table);\r\n  }\r\n\r\n  initRemove() {\r\n    let grid = this.grid;\r\n    let terrain = this.terrain;\r\n    let zoocontroller = this.zoocontroller;\r\n\r\n    this.remove.addEventListener("drop", function(e) {\r\n      let data = e.dataTransfer.getData("Text");\r\n      let monster = document.getElementById(data);\r\n      if (monster != null) {\r\n        let origin = monster.getAttribute("id").split("x");\r\n\r\n        zoocontroller.deleteMonsterFromGrid(\r\n          grid,\r\n          terrain,\r\n          origin[0],\r\n          origin[1]\r\n        );\r\n\r\n        monster.remove();\r\n      }\r\n    });\r\n\r\n    this.remove.addEventListener("dragover", function(e) {\r\n      e.preventDefault();\r\n    });\r\n\r\n    this.remove.addEventListener("dragenter", function(e) {\r\n      e.preventDefault();\r\n    });\r\n  }\r\n}\r\n\n// CONCATENATED MODULE: ./src/Model/WeatherDataService.js\nclass WeatherDataService {\r\n\r\n    constructor() {\r\n        this.apikey = \'6efc35c3c2611e414ea66da76b2e3f0b\';\r\n        this.units = \'metric\';\r\n    }\r\n\r\n    getCurrentWeather(cityName) {\r\n        return fetch(`http://api.openweathermap.org/data/2.5/weather?q=${cityName}&appid=${this.apikey}&units=${this.units}`)\r\n        .then(function(response) {\r\n          return response.json();\r\n        })\r\n        .then(function(myJson) {\r\n          return myJson;\r\n        });\r\n      }\r\n}\n// CONCATENATED MODULE: ./src/View/WeatherView.js\nclass WeatherView {\r\n\r\n    constructor() {\r\n        this.img = document.getElementById(\'weatherimg\');\r\n        this.temp = document.getElementById(\'temp\');\r\n        this.rain = false;\r\n\r\n        this.initRainSwitch();\r\n    }\r\n\r\n    initRainSwitch() {\r\n        let rainswitch = document.getElementById(\'rainswitch\');\r\n        let ownclass = this;\r\n        rainswitch.addEventListener("click", function(e) {\r\n            e.preventDefault();\r\n            if(ownclass.rain) {\r\n                ownclass.updateWeather(ownclass.temperature, "Clear");\r\n                ownclass.rain = false;\r\n            } else {\r\n                ownclass.updateWeather(ownclass.temperature, "Rain");\r\n            }\r\n        });\r\n    }\r\n\r\n    updateWeather(temp, rain) {\r\n        this.temperature = temp;\r\n        this.temp.innerText = `${temp}Â° Celcius`;\r\n\r\n\r\n        if(rain === \'Rain\' || rain === \'Shower rain\') {\r\n            this.rain = true;\r\n            if(document.getElementById(\'rain\') === null) {\r\n                let canvas = document.createElement(\'canvas\');\r\n                canvas.setAttribute(\'id\', \'rain\');\r\n                document.getElementById(\'map\').appendChild(canvas);\r\n                this.startRain(300);\r\n            }\r\n        } else {\r\n            let canvas = document.getElementById(\'rain\');\r\n            if(canvas !== null) {\r\n                canvas.parentNode.removeChild(canvas);\r\n            }\r\n        }\r\n    }\r\n\r\n    startRain(maxParts) {\r\n        let canvas = document.getElementById("rain");\r\n\r\n        if (canvas.getContext) {\r\n            let ctx = canvas.getContext(\'2d\');\r\n            let w = canvas.width;\r\n            let h = canvas.height;\r\n            ctx.strokeStyle = \'rgba(46,86,147,0.3)\';\r\n            ctx.lineWidth = 0.7;\r\n            ctx.lineCap = \'round\';\r\n\r\n\r\n            let init = [];\r\n            for (let a = 0; a < maxParts; a++) {\r\n                init.push({\r\n                    x: Math.random() * w,\r\n                    y: Math.random() * h,\r\n                    l: Math.random() * 1,\r\n                    xs: -4 + Math.random() * 4 + 2,\r\n                    ys: Math.random() * 10 + 10\r\n                })\r\n            }\r\n\r\n            let particles = [];\r\n            for (let b = 0; b < maxParts; b++) {\r\n                particles[b] = init[b];\r\n            }\r\n\r\n            function draw() {\r\n                ctx.clearRect(0, 0, w, h);\r\n                for (let c = 0; c < particles.length; c++) {\r\n                    let p = particles[c];\r\n                    ctx.beginPath();\r\n                    ctx.moveTo(p.x, p.y);\r\n                    ctx.lineTo(p.x + p.l * p.xs, p.y + p.l * p.ys);\r\n                    ctx.stroke();\r\n                }\r\n                move();\r\n            }\r\n\r\n            function move() {\r\n                for (let b = 0; b < particles.length; b++) {\r\n                    let p = particles[b];\r\n                    p.x += p.xs;\r\n                    p.y += p.ys;\r\n                    if (p.x > w || p.y > h) {\r\n                        p.x = Math.random() * w;\r\n                        p.y = -20;\r\n                    }\r\n                }\r\n            }\r\n\r\n            setInterval(draw, 80);\r\n\r\n        }\r\n    }\r\n}\n// CONCATENATED MODULE: ./src/Controller/WeatherController.js\n\r\n\r\n\r\nclass WeatherController_WeatherController {\r\n    constructor() {\r\n        this.weatherdata = new WeatherDataService();\r\n        this.weatherview = new WeatherView();\r\n    }\r\n\r\n    updateWeather(city) {\r\n        let weatherview = this.weatherview;\r\n        this.weatherdata.getCurrentWeather(city).then(function(data) {\r\n            weatherview.updateWeather(data.main.temp, data.weather[0].main);\r\n        });\r\n    }\r\n}\n// CONCATENATED MODULE: ./src/Model/MapService.js\nclass MapService {\r\n  loadGrid() {\r\n    return fetch("./map/grid.json")\r\n      .then(function(response) {\r\n        return response.json();\r\n      })\r\n      .then(function(grid) {\r\n        let STORAGE_KEY = "zoo-grid";\r\n\r\n        // Put the whole grid from localstorage in a variable\r\n        let storage = JSON.parse(localStorage.getItem(STORAGE_KEY));\r\n\r\n        if (storage != null) {\r\n          grid = storage;\r\n\r\n        // If the grid is not present in localstorage yet, put the whole grid as loaded from the local grid.json file in there\r\n        } else {\r\n          localStorage.setItem(STORAGE_KEY, JSON.stringify(grid));\r\n        }\r\n\r\n        return grid;\r\n      });\r\n  }\r\n\r\n  addMonsterToGrid(grid, terrain, monster, x, y) {\r\n    monster.x = x;\r\n    monster.y = y;\r\n    monster.map = terrain;\r\n    grid[terrain].grid[x].Columns[y] = monster;\r\n    this.saveToLocalStorage(grid);\r\n  }\r\n\r\n  deleteMonsterFromGrid(grid, terrain, x, y) {\r\n    grid[terrain].grid[x].Columns[y] = "0";\r\n    this.saveToLocalStorage(grid);\r\n  }\r\n\r\n  saveToLocalStorage(grid) {\r\n    let STORAGE_KEY = "zoo-grid";\r\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(grid));\r\n  }\r\n\r\n}\r\n\n// CONCATENATED MODULE: ./src/Controller/ZooController.js\n\r\n\r\n\r\n\r\n\r\n\r\nclass ZooController_ZooController\r\n{\r\n    //el constructor\r\n    constructor(){\r\n        this.weathercontroller = new WeatherController_WeatherController();\r\n\r\n        this.monsterservice = new MonsterService_MonsterService();\r\n        this.createmonsterview =  new CreateMonsterView(this);\r\n        this.mapservice = new MapService();\r\n\r\n        this.mapview = new MapView(this, this.weathercontroller);\r\n    }\r\n\r\n    addMonsterToGrid(grid, terrain, x, y) {\r\n        this.mapservice.addMonsterToGrid(grid, terrain, this.getLastMonster(), x, y);\r\n    }\r\n\r\n    deleteMonsterFromGrid(grid, terrain, x, y) {\r\n        this.mapservice.deleteMonsterFromGrid(grid, terrain, x, y);\r\n    }\r\n\r\n    addMonster(name, element, arms, typearms, legs, eyes, furtype, fly, swim, colour, map, x, y){\r\n        this.monsterservice.saveMonster(name, element, arms, typearms, legs, eyes, furtype, fly, swim, colour, map, x, y);\r\n    }\r\n\r\n    loadGrid(mapview) {\r\n        this.mapservice.loadGrid().then(function(grid) {\r\n            mapview.paintGrid(grid);\r\n        });\r\n    }\r\n\r\n    getLastMonster() {\r\n        return this.monsterservice.getLastMonster();\r\n    }\r\n}\n// CONCATENATED MODULE: ./src/app.js\n\r\n\r\nlet zoocontroller = new ZooController_ZooController();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvbW9kZWwvTW9uc3Rlci5qcz81MThkIiwid2VicGFjazovLy8uL3NyYy9tb2RlbC9Nb25zdGVyU2VydmljZS5qcz8wODkyIiwid2VicGFjazovLy8uL3NyYy92aWV3L0NyZWF0ZU1vbnN0ZXJWaWV3LmpzP2M3NzAiLCJ3ZWJwYWNrOi8vLy4vc3JjL3ZpZXcvTWFwVmlldy5qcz8wOTQ4Iiwid2VicGFjazovLy8uL3NyYy9Nb2RlbC9XZWF0aGVyRGF0YVNlcnZpY2UuanM/ZmM4ZSIsIndlYnBhY2s6Ly8vLi9zcmMvVmlldy9XZWF0aGVyVmlldy5qcz84NjFjIiwid2VicGFjazovLy8uL3NyYy9Db250cm9sbGVyL1dlYXRoZXJDb250cm9sbGVyLmpzPzE1ZjQiLCJ3ZWJwYWNrOi8vLy4vc3JjL01vZGVsL01hcFNlcnZpY2UuanM/MjA4MiIsIndlYnBhY2s6Ly8vLi9zcmMvQ29udHJvbGxlci9ab29Db250cm9sbGVyLmpzP2JjZDkiLCJ3ZWJwYWNrOi8vLy4vc3JjL2FwcC5qcz8xMTEyIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxJOztBQzlCb0M7OztBQUc3QixNQUFNLDZCQUFjO0FBQzNCO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixPQUFPO0FBQ3ZCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSw2QkFBNkIsT0FBTztBQUNwQztBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7QUN4Qk87O0FBRVA7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsT0FBTztBQUNqQztBQUNBLDhDQUE4QyxFQUFFO0FBQ2hEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixPQUFPO0FBQ2pDO0FBQ0EsOENBQThDLEVBQUU7QUFDaEQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFROztBQUVSOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTs7QUFFUjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7O0FBRVI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFROztBQUVSO0FBQ0E7QUFDQTs7O0FDMVZPO0FBQ1A7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxtQkFBbUIsYUFBYTtBQUNoQztBQUNBLHFCQUFxQixhQUFhO0FBQ2xDOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOzs7QUM1UE87O0FBRVA7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSx5RUFBeUUsU0FBUyxTQUFTLFlBQVksU0FBUyxXQUFXO0FBQzNIO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEM7O0FDaEJPOztBQUVQO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQSxpQ0FBaUMsS0FBSzs7O0FBR3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0EsMkJBQTJCLGNBQWM7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCOztBQUVBO0FBQ0EsMkJBQTJCLGNBQWM7QUFDekM7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsK0JBQStCLHNCQUFzQjtBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsK0JBQStCLHNCQUFzQjtBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEM7O0FDckdpRTtBQUNmOztBQUUzQyxNQUFNLG1DQUFpQjtBQUM5QjtBQUNBLCtCQUErQixrQkFBa0I7QUFDakQsK0JBQStCLFdBQVc7QUFDMUM7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxDOztBQ2ZPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBLE9BQU87QUFDUDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7O0FDMUN3RDtBQUNNO0FBQ3BCO0FBQ2M7QUFDUDs7QUFFbEMsTUFBTSwyQkFBYTtBQUNsQztBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsbUNBQWlCOztBQUV0RCxrQ0FBa0MsNkJBQWM7QUFDaEQsc0NBQXNDLGlCQUFpQjtBQUN2RCw4QkFBOEIsVUFBVTs7QUFFeEMsMkJBQTJCLE9BQU87QUFDbEM7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEM7O0FDeEN1RDs7QUFFdkQsd0JBQXdCLDJCQUFhIiwiZmlsZSI6IjAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY2xhc3MgTW9uc3RlcntcclxuICAgIC8vIE1vbnN0ZXJEYXRhIGNvbnNpc3RzIG9mIGVsZW1lbnQsIG5hbWUsIGFybXMsIHR5cGVfYXJtcywgbGVncywgZXllcywgc2tpbnR5cGUsIGFiaWxpdHkgdG8gZmx5LCBhYmlsaXR5IHRvIHN3aW0sIGNvbG91ciAsbWFwLCB4IGNvb3JkaW5hdGUsIHkgY29vcmRpbmF0ZVxyXG4gICAgY29uc3RydWN0b3IobmFtZSwgZWxlbWVudCwgYXJtcywgdHlwZWFybXMsIGxlZ3MsIGV5ZXMsIGZ1cnR5cGUsIGZseSwgc3dpbSwgY29sb3VyLCBtYXAsIHgsIHkpe1xyXG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcclxuICAgICAgICB0aGlzLmFybXMgPSBhcm1zO1xyXG4gICAgICAgIHRoaXMudHlwZWFybXMgPSB0eXBlYXJtcztcclxuICAgICAgICB0aGlzLmxlZ3MgPSBsZWdzO1xyXG4gICAgICAgIHRoaXMuZXllcyA9IGV5ZXM7XHJcbiAgICAgICAgdGhpcy5mdXJ0eXBlID0gZnVydHlwZTtcclxuICAgICAgICB0aGlzLmZseSA9IGZseTtcclxuICAgICAgICB0aGlzLnN3aW0gPSBzd2ltO1xyXG4gICAgICAgIHRoaXMuY29sb3VyID0gY29sb3VyO1xyXG4gICAgICAgIHRoaXMubWFwID0gbWFwO1xyXG4gICAgICAgIHRoaXMueCA9IHg7XHJcbiAgICAgICAgdGhpcy55ID0geTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gY2xhc3MgZmlyZU1vbnN0ZXIgZXh0ZW5kcyBNb25zdGVye1xyXG5cclxuLy8gfVxyXG4vLyBjbGFzcyB3YXRlcmZpcmVNb25zdGVyIGV4dGVuZHMgTW9uc3RlcntcclxuICAgIFxyXG4vLyB9XHJcbi8vIGNsYXNzIGVhcnRoTW9uc3RlciBleHRlbmRzIE1vbnN0ZXJ7XHJcbiAgICBcclxuLy8gfVxyXG4vLyBjbGFzcyB3aW5kTW9uc3RlciBleHRlbmRzIE1vbnN0ZXJ7XHJcbiAgICBcclxuLy8gfSIsImltcG9ydCB7IE1vbnN0ZXIgfSBmcm9tICcuL01vbnN0ZXInO1xyXG5cclxuXHJcbmV4cG9ydCBjbGFzcyBNb25zdGVyU2VydmljZVxyXG57XHJcbiAgICBjb25zdHJ1Y3Rvcigpe1xyXG4gICAgICAgIHRoaXMubW9uc3RlcnMgPSBbXHJcbiAgICAgICAgICAgIG5ldyBNb25zdGVyKFwiZmlyZVwiLCBcIk1hcmlqblwiLCAyLCBcInRlbnRhY2xlc1wiLCAyLCA0LCBcInNjYWxlc1wiLCBmYWxzZSwgZmFsc2UsIFwib3JhbmdlXCIsIDAsIDEsIDEpXHJcbiAgICAgICAgXVxyXG4gICAgfVxyXG5cclxuICAgIGdldE1vbnN0ZXJzKClcclxuICAgIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5tb25zdGVycztcclxuICAgIH1cclxuXHJcbiAgICBzYXZlTW9uc3RlcihuYW1lLCBlbGVtZW50LCBhcm1zLCB0eXBlYXJtcywgbGVncywgZXllcywgZnVydHlwZSwgZmx5LCBzd2ltLCBjb2xvdXIsIG1hcCwgeCwgeSl7XHJcbiAgICAgICAgbGV0IG5ld01vbnN0ZXIgPSBuZXcgTW9uc3RlcihuYW1lLCBlbGVtZW50LCBhcm1zLCB0eXBlYXJtcywgbGVncywgZXllcywgZnVydHlwZSwgZmx5LCBzd2ltLCBjb2xvdXIsIG1hcCwgeCwgeSk7XHJcbiAgICAgICAgdGhpcy5tb25zdGVycy5wdXNoKG5ld01vbnN0ZXIpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldExhc3RNb25zdGVyKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLm1vbnN0ZXJzW3RoaXMubW9uc3RlcnMubGVuZ3RoIC0xXTtcclxuICAgIH1cclxufVxyXG4iLCJleHBvcnQgY2xhc3MgQ3JlYXRlTW9uc3RlclZpZXcge1xyXG5cclxuICBjb25zdHJ1Y3Rvcihjb250cm9sbGVyKSB7XHJcbiAgICB0aGlzLmNvbnRyb2xsZXIgPSBjb250cm9sbGVyO1xyXG5cclxuICAgIHRoaXMudGVtcGxhdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNyZWF0ZV9tb25zdGVyXCIpO1xyXG5cclxuICAgIHRoaXMucmFkaW9fZmlyZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZWxlbWVudF9maXJlXCIpO1xyXG4gICAgdGhpcy5yYWRpb193YXRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZWxlbWVudF93YXRlclwiKTtcclxuICAgIHRoaXMucmFkaW9fZWFydGggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVsZW1lbnRfZWFydGhcIik7XHJcbiAgICB0aGlzLnJhZGlvX3dpbmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVsZW1lbnRfd2luZFwiKTtcclxuICAgIHRoaXMucmVtb3ZlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZW1vdmVcIik7XHJcblxyXG4gICAgdGhpcy5zZXRFbGVtZW50RXZlbnRzKCk7XHJcbiAgICAvLyB0aGlzLnNldEV2ZW50cygpO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlRm9ybShjb250cm9sbGVyKSB7XHJcbiAgICB0aGlzLm1vbnN0ZXJmb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtb25zdGVyX2Zvcm1cIik7XHJcbiAgICBsZXQgY3JlYXRlZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY3JlYXRlZFwiKTtcclxuXHJcbiAgICB0aGlzLm1vbnN0ZXJmb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgZnVuY3Rpb24oZSkge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICBpZiAoY3JlYXRlZC5oYXNDaGlsZE5vZGVzKCkpIHtcclxuICAgICAgICB3aGlsZSAoY3JlYXRlZC5maXJzdENoaWxkKSB7XHJcbiAgICAgICAgICBjcmVhdGVkLnJlbW92ZUNoaWxkKGNyZWF0ZWQuZmlyc3RDaGlsZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuaW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImltZ1wiKTtcclxuICAgICAgdGhpcy5pbWcuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJjcmVhdGVkXCIpO1xyXG5cclxuICAgICAgbGV0IHNyYyA9IFwiXCI7XHJcblxyXG4gICAgICBjb25zb2xlLmxvZyh0aGlzLmVsZW1lbnQudmFsdWUpXHJcblxyXG4gICAgICBzd2l0Y2ggKHRoaXMuZWxlbWVudC52YWx1ZSkge1xyXG4gICAgICAgIGNhc2UgXCJmaXJlXCI6XHJcbiAgICAgICAgICBzcmMgPSBcIi4uL3NyYy9SZXNvdXJjZXMvb3JhbmdlbW9uc3Rlci5wbmdcIjtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgXCJ3YXRlclwiOlxyXG4gICAgICAgICAgc3JjID0gXCIuLi9zcmMvUmVzb3VyY2VzL2JsdWVtb25zdGVyLnBuZ1wiO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBcImVhcnRoXCI6XHJcbiAgICAgICAgICBzcmMgPSBcIi4uL3NyYy9SZXNvdXJjZXMvYnJvd25tb25zdGVyLnBuZ1wiO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBcIndpbmRcIjpcclxuICAgICAgICAgIHNyYyA9IFwiLi4vc3JjL1Jlc291cmNlcy93aGl0ZW1vbnN0ZXIucG5nXCI7XHJcbiAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuaW1nLnNyYyA9IHNyYztcclxuICAgICAgdGhpcy5pbWcuZHJhZ2dhYmxlID0gdHJ1ZTtcclxuICAgICAgdGhpcy5pbWcuc2V0QXR0cmlidXRlKCdpZCcsICctMXgtMScpO1xyXG4gICAgICB0aGlzLmltZy5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ3N0YXJ0XCIsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICBlLmRhdGFUcmFuc2Zlci5zZXREYXRhKFwiVGV4dFwiLCBlLnRhcmdldC5pZCk7XHJcbiAgICAgIH0pO1xyXG4gICAgICBjcmVhdGVkLmFwcGVuZENoaWxkKHRoaXMuaW1nKTtcclxuXHJcbiAgICAgIGxldCBuYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJuYW1lXCIpLnZhbHVlO1xyXG4gICAgICBsZXQgZWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZWxlbWVudFwiKS52YWx1ZTtcclxuICAgICAgbGV0IGFybXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFybXNcIikudmFsdWU7XHJcbiAgICAgIGxldCB0eXBlYXJtcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidHlwZV9hcm1zXCIpLnZhbHVlO1xyXG4gICAgICBsZXQgbGVncyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibGVnc1wiKS52YWx1ZTtcclxuICAgICAgbGV0IGV5ZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImV5ZXNcIikudmFsdWU7XHJcbiAgICAgIGxldCBmdXJ0eXBlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJmdXJ0eXBlXCIpLnZhbHVlO1xyXG4gICAgICBsZXQgZmx5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJmbHlcIikudmFsdWU7XHJcbiAgICAgIGxldCBzd2ltID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzd2ltXCIpLnZhbHVlO1xyXG4gICAgICBsZXQgY29sb3VyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb2xvdXJcIikudmFsdWU7XHJcbiAgICAgIFxyXG4gICAgICBjb250cm9sbGVyLmFkZE1vbnN0ZXIobmFtZSwgZWxlbWVudCwgYXJtcywgdHlwZWFybXMsIGxlZ3MsIGV5ZXMsIGZ1cnR5cGUsIGZseSwgc3dpbSwgY29sb3VyLCBudWxsLCBudWxsLCBudWxsKTtcclxuXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHNldEVsZW1lbnRFdmVudHMoKSB7XHJcbiAgICB0aGlzLnJhZGlvX2ZpcmUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgaWYgKHRoaXMuY2hlY2tlZCkge1xyXG4gICAgICAgICAgICBsZXQgZm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibW9uc3Rlcl9mb3JtXCIpO1xyXG4gICAgICAgICAgICAvLyBUT0RPOiBSZW1vdmUgcHJldmlvdXMgZm9ybVxyXG5cclxuICAgICAgICAgICAgbGV0IGZpZWxkc2V0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImZpZWxkc2V0XCIpO1xyXG4gICAgICAgICAgICBsZXQgbmFtZWxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxhYmVsXCIpO1xyXG4gICAgICAgICAgICBuYW1lbGFiZWwuaW5uZXJIVE1MID0gXCJOYW1lOlwiO1xyXG4gICAgICAgICAgICBsZXQgbmFtZWlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xyXG4gICAgICAgICAgICBuYW1laW5wdXQuc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJuYW1lXCIpO1xyXG4gICAgICAgICAgICBuYW1laW5wdXQuc2V0QXR0cmlidXRlKFwibmFtZVwiLCBcIm5hbWVcIik7XHJcblxyXG4gICAgICAgICAgICBmaWVsZHNldC5hcHBlbmRDaGlsZChuYW1lbGFiZWwpO1xyXG4gICAgICAgICAgICBmaWVsZHNldC5hcHBlbmRDaGlsZChuYW1laW5wdXQpO1xyXG5cclxuICAgICAgICAgICAgZm9ybS5hcHBlbmRDaGlsZChmaWVsZHNldCk7XHJcblxyXG4gICAgICAgICAgICBsZXQgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcclxuICAgICAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBcImVsZW1lbnRcIik7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKFwidmFsdWVcIiwgXCJmaXJlXCIpO1xyXG4gICAgICAgICAgICBlbGVtZW50LmhpZGRlbiA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICBmb3JtLmFwcGVuZENoaWxkKGVsZW1lbnQpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgbGV0IGZpZWxkc2V0MiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJmaWVsZHNldFwiKTtcclxuICAgICAgICAgICAgbGV0IGFybXNsYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsYWJlbFwiKTtcclxuICAgICAgICAgICAgYXJtc2xhYmVsLmlubmVySFRNTCA9IFwiQXJtczpcIjtcclxuICAgICAgICAgICAgbGV0IHNlbGVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzZWxlY3RcIik7XHJcbiAgICAgICAgICAgIHNlbGVjdC5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBcImFybXNcIik7XHJcbiAgICAgICAgICAgIGZvcihsZXQgaSA9IDE7IGkgPCA3OyBpKyspIHtcclxuICAgICAgICAgICAgICBsZXQgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiKTtcclxuICAgICAgICAgICAgICBvcHRpb24uc2V0QXR0cmlidXRlKFwidmFsdWVcIiwgYCR7aX1gKTtcclxuICAgICAgICAgICAgICBvcHRpb24uaW5uZXJIVE1MID0gaTtcclxuICAgICAgICAgICAgICBzZWxlY3QuYXBwZW5kQ2hpbGQob3B0aW9uKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZmllbGRzZXQyLmFwcGVuZENoaWxkKGFybXNsYWJlbCk7XHJcbiAgICAgICAgICAgIGZpZWxkc2V0Mi5hcHBlbmRDaGlsZChzZWxlY3QpO1xyXG5cclxuICAgICAgICAgICAgZm9ybS5hcHBlbmRDaGlsZChmaWVsZHNldDIpO1xyXG5cclxuICAgICAgICAgICAgbGV0IGZpZWxkc2V0MyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJmaWVsZHNldFwiKTtcclxuICAgICAgICAgICAgbGV0IHR5cGVhcm1zbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGFiZWxcIik7XHJcbiAgICAgICAgICAgIHR5cGVhcm1zbGFiZWwuaW5uZXJIVE1MID0gXCJUeXBlIGFybXM6XCJcclxuXHJcbiAgICAgICAgICAgIGxldCB0eXBlYXJtc3NlbGVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzZWxlY3RcIik7XHJcbiAgICAgICAgICAgIHR5cGVhcm1zc2VsZWN0LnNldEF0dHJpYnV0ZShcImlkXCIsIFwidHlwZV9hcm1zXCIpO1xyXG4gICAgICAgICAgICBsZXQgb3B0aW9uMSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIik7XHJcbiAgICAgICAgICAgIG9wdGlvbjEuc2V0QXR0cmlidXRlKFwidmFsdWVcIiwgXCJ0ZW50YWNsZXNcIik7XHJcbiAgICAgICAgICAgIG9wdGlvbjEuaW5uZXJIVE1MID0gXCJUZW50YWNsZXNcIjtcclxuICAgICAgICAgICAgbGV0IG9wdGlvbjIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIpO1xyXG4gICAgICAgICAgICBvcHRpb24yLnNldEF0dHJpYnV0ZShcInZhbHVlXCIsIFwiY2xhd3NcIik7XHJcbiAgICAgICAgICAgIG9wdGlvbjIuaW5uZXJIVE1MID0gXCJDbGF3c1wiO1xyXG4gICAgICAgICAgICBsZXQgb3B0aW9uMyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIik7XHJcbiAgICAgICAgICAgIG9wdGlvbjMuc2V0QXR0cmlidXRlKFwidmFsdWVcIiwgXCJjbGF3LXdpbmdzXCIpO1xyXG4gICAgICAgICAgICBvcHRpb24zLmlubmVySFRNTCA9IFwiQ2xhdy13aW5nc1wiO1xyXG5cclxuICAgICAgICAgICAgdHlwZWFybXNzZWxlY3QuYXBwZW5kQ2hpbGQob3B0aW9uMSk7XHJcbiAgICAgICAgICAgIHR5cGVhcm1zc2VsZWN0LmFwcGVuZENoaWxkKG9wdGlvbjIpO1xyXG4gICAgICAgICAgICB0eXBlYXJtc3NlbGVjdC5hcHBlbmRDaGlsZChvcHRpb24zKTtcclxuXHJcbiAgICAgICAgICAgIGZpZWxkc2V0My5hcHBlbmRDaGlsZCh0eXBlYXJtc3NlbGVjdCk7XHJcblxyXG4gICAgICAgICAgICBmb3JtLmFwcGVuZENoaWxkKHR5cGVhcm1zbGFiZWwpO1xyXG4gICAgICAgICAgICBmb3JtLmFwcGVuZENoaWxkKGZpZWxkc2V0Myk7XHJcblxyXG4gICAgICAgICAgICBsZXQgZmllbGRzZXQ0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImZpZWxkc2V0XCIpO1xyXG4gICAgICAgICAgICBsZXQgbGVnc2xhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxhYmVsXCIpO1xyXG4gICAgICAgICAgICBsZWdzbGFiZWwuaW5uZXJIVE1MID0gXCJMZWdzOiAyXCI7XHJcblxyXG4gICAgICAgICAgICBsZXQgbGVnc2lucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xyXG4gICAgICAgICAgICBsZWdzaW5wdXQuc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJsZWdzXCIpO1xyXG4gICAgICAgICAgICBsZWdzaW5wdXQuc2V0QXR0cmlidXRlKFwidmFsdWVcIiwgXCIyXCIpO1xyXG4gICAgICAgICAgICBsZWdzaW5wdXQuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJoaWRkZW5cIik7XHJcblxyXG4gICAgICAgICAgICBmaWVsZHNldDQuYXBwZW5kQ2hpbGQobGVnc2xhYmVsKTtcclxuICAgICAgICAgICAgZmllbGRzZXQ0LmFwcGVuZENoaWxkKGxlZ3NpbnB1dCk7XHJcbiAgICAgICAgICAgIGZvcm0uYXBwZW5kQ2hpbGQoZmllbGRzZXQ0KTtcclxuXHJcbiAgICAgICAgICAgIGxldCBmaWVsZHNldDkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZmllbGRzZXRcIik7XHJcbiAgICAgICAgICAgIGxldCBleWVzbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGFiZWxcIik7XHJcbiAgICAgICAgICAgIGV5ZXNsYWJlbC5pbm5lckhUTUwgPSBcIkV5ZXM6XCI7XHJcbiAgICAgICAgICAgIGxldCBzZWxlY3QyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNlbGVjdFwiKTtcclxuICAgICAgICAgICAgc2VsZWN0Mi5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBcImV5ZXNcIik7XHJcbiAgICAgICAgICAgIGZvcihsZXQgaSA9IDE7IGkgPCA1OyBpKyspIHtcclxuICAgICAgICAgICAgICBsZXQgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiKTtcclxuICAgICAgICAgICAgICBvcHRpb24uc2V0QXR0cmlidXRlKFwidmFsdWVcIiwgYCR7aX1gKTtcclxuICAgICAgICAgICAgICBvcHRpb24uaW5uZXJIVE1MID0gaTtcclxuICAgICAgICAgICAgICBzZWxlY3QyLmFwcGVuZENoaWxkKG9wdGlvbik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZpZWxkc2V0OS5hcHBlbmRDaGlsZChleWVzbGFiZWwpO1xyXG4gICAgICAgICAgICBmaWVsZHNldDkuYXBwZW5kQ2hpbGQoc2VsZWN0Mik7XHJcblxyXG4gICAgICAgICAgICBmb3JtLmFwcGVuZChmaWVsZHNldDkpO1xyXG5cclxuICAgICAgICAgICAgbGV0IGZpZWxkc2V0NSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJmaWVsZHNldFwiKTtcclxuICAgICAgICAgICAgbGV0IGZ1cnR5cGVsYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsYWJlbFwiKTtcclxuICAgICAgICAgICAgZnVydHlwZWxhYmVsLmlubmVySFRNTCA9IFwiRnVyIHR5cGU6XCI7XHJcbiAgICAgICAgICAgIGxldCB0eXBlZnVyc2VsZWN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNlbGVjdFwiKTtcclxuICAgICAgICAgICAgdHlwZWZ1cnNlbGVjdC5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBcImZ1cnR5cGVcIik7XHJcbiAgICAgICAgICAgIGxldCBvcHRpb24xMSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIik7XHJcbiAgICAgICAgICAgIG9wdGlvbjExLnNldEF0dHJpYnV0ZShcInZhbHVlXCIsIFwic2NhbGVzXCIpO1xyXG4gICAgICAgICAgICBvcHRpb24xMS5pbm5lckhUTUwgPSBcIlNjYWxlc1wiO1xyXG4gICAgICAgICAgICBsZXQgb3B0aW9uMjIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIpO1xyXG4gICAgICAgICAgICBvcHRpb24yMi5zZXRBdHRyaWJ1dGUoXCJ2YWx1ZVwiLCBcImZlYXRoZXJzXCIpO1xyXG4gICAgICAgICAgICBvcHRpb24yMi5pbm5lckhUTUwgPSBcIkZlYXRoZXJzXCI7XHJcblxyXG4gICAgICAgICAgICB0eXBlZnVyc2VsZWN0LmFwcGVuZENoaWxkKG9wdGlvbjExKTtcclxuICAgICAgICAgICAgdHlwZWZ1cnNlbGVjdC5hcHBlbmRDaGlsZChvcHRpb24yMik7XHJcblxyXG4gICAgICAgICAgICBmaWVsZHNldDUuYXBwZW5kQ2hpbGQoZnVydHlwZWxhYmVsKTtcclxuICAgICAgICAgICAgZmllbGRzZXQ1LmFwcGVuZENoaWxkKHR5cGVmdXJzZWxlY3QpO1xyXG4gICAgICAgICAgICBmb3JtLmFwcGVuZENoaWxkKGZpZWxkc2V0NSk7XHJcblxyXG4gICAgICAgICAgICBsZXQgZmllbGRzZXQ2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImZpZWxkc2V0XCIpO1xyXG4gICAgICAgICAgICBsZXQgZmx5bGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGFiZWxcIik7XHJcbiAgICAgICAgICAgIGZseWxhYmVsLmlubmVySFRNTCA9IFwiQ2FuIGZseTogbm9cIjtcclxuICAgICAgICAgICAgbGV0IGZseSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcclxuICAgICAgICAgICAgZmx5LnNldEF0dHJpYnV0ZShcImlkXCIsIFwiZmx5XCIpO1xyXG4gICAgICAgICAgICBmbHkuc2V0QXR0cmlidXRlKFwidmFsdWVcIiwgXCJmYWxzZVwiKTtcclxuICAgICAgICAgICAgZmx5LnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwiaGlkZGVuXCIpO1xyXG5cclxuICAgICAgICAgICAgZmllbGRzZXQ2LmFwcGVuZENoaWxkKGZseWxhYmVsKTtcclxuICAgICAgICAgICAgZmllbGRzZXQ2LmFwcGVuZENoaWxkKGZseSk7XHJcblxyXG4gICAgICAgICAgICBmb3JtLmFwcGVuZENoaWxkKGZpZWxkc2V0Nik7XHJcblxyXG4gICAgICAgICAgICBsZXQgZmllbGRzZXQ3ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImZpZWxkc2V0XCIpO1xyXG4gICAgICAgICAgICBsZXQgc3dpbWxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxhYmVsXCIpO1xyXG4gICAgICAgICAgICBzd2ltbGFiZWwuaW5uZXJIVE1MID0gXCJDYW4gc3dpbTogbm9cIjtcclxuICAgICAgICAgICAgbGV0IHN3aW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XHJcbiAgICAgICAgICAgIHN3aW0uc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJzd2ltXCIpO1xyXG4gICAgICAgICAgICBzd2ltLnNldEF0dHJpYnV0ZShcInZhbHVlXCIsIFwiZmFsc2VcIik7XHJcbiAgICAgICAgICAgIHN3aW0uc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJoaWRkZW5cIik7XHJcblxyXG4gICAgICAgICAgICBmaWVsZHNldDYuYXBwZW5kQ2hpbGQoc3dpbWxhYmVsKTtcclxuICAgICAgICAgICAgZmllbGRzZXQ2LmFwcGVuZENoaWxkKHN3aW0pO1xyXG5cclxuICAgICAgICAgICAgZm9ybS5hcHBlbmRDaGlsZChmaWVsZHNldDcpO1xyXG5cclxuICAgICAgICAgICAgbGV0IGZpZWxkc2V0OCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJmaWVsZHNldFwiKTtcclxuICAgICAgICAgICAgbGV0IGNvbG91cmxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxhYmVsXCIpO1xyXG4gICAgICAgICAgICBjb2xvdXJsYWJlbC5pbm5lckhUTUwgPSBcIkNvbG91cjpcIlxyXG5cclxuICAgICAgICAgICAgbGV0IGNvbG91cnNlbGVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzZWxlY3RcIik7XHJcbiAgICAgICAgICAgIGNvbG91cnNlbGVjdC5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBcImNvbG91clwiKTtcclxuICAgICAgICAgICAgbGV0IG9wdGlvbjExMSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIik7XHJcbiAgICAgICAgICAgIG9wdGlvbjExMS5zZXRBdHRyaWJ1dGUoXCJ2YWx1ZVwiLCBcInJlZFwiKTtcclxuICAgICAgICAgICAgb3B0aW9uMTExLmlubmVySFRNTCA9IFwiUmVkXCI7XHJcbiAgICAgICAgICAgIGxldCBvcHRpb24yMjIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIpO1xyXG4gICAgICAgICAgICBvcHRpb24yMjIuc2V0QXR0cmlidXRlKFwidmFsdWVcIiwgXCJvcmFuZ2VcIik7XHJcbiAgICAgICAgICAgIG9wdGlvbjIyMi5pbm5lckhUTUwgPSBcIk9yYW5nZVwiO1xyXG4gICAgICAgICAgICBsZXQgb3B0aW9uMzMzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIm9wdGlvblwiKTtcclxuICAgICAgICAgICAgb3B0aW9uMzMzLnNldEF0dHJpYnV0ZShcInZhbHVlXCIsIFwiYnJvd25cIik7XHJcbiAgICAgICAgICAgIG9wdGlvbjMzMy5pbm5lckhUTUwgPSBcIkJyb3duXCI7XHJcblxyXG4gICAgICAgICAgICBjb2xvdXJzZWxlY3QuYXBwZW5kQ2hpbGQob3B0aW9uMTExKTtcclxuICAgICAgICAgICAgY29sb3Vyc2VsZWN0LmFwcGVuZENoaWxkKG9wdGlvbjIyMik7XHJcbiAgICAgICAgICAgIGNvbG91cnNlbGVjdC5hcHBlbmRDaGlsZChvcHRpb24zMzMpO1xyXG5cclxuICAgICAgICAgICAgZmllbGRzZXQ4LmFwcGVuZENoaWxkKGNvbG91cnNlbGVjdCk7XHJcblxyXG4gICAgICAgICAgICBmb3JtLmFwcGVuZENoaWxkKGNvbG91cmxhYmVsKTtcclxuICAgICAgICAgICAgZm9ybS5hcHBlbmRDaGlsZChmaWVsZHNldDgpO1xyXG5cclxuICAgICAgICAgICAgbGV0IHJlc2V0YnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xyXG4gICAgICAgICAgICByZXNldGJ1dHRvbi5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwicmVzZXRcIik7XHJcbiAgICAgICAgICAgIHJlc2V0YnV0dG9uLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwibmVzLWJ0biBpcy1lcnJvclwiKTtcclxuICAgICAgICAgICAgcmVzZXRidXR0b24uc2V0QXR0cmlidXRlKFwidmFsdWVcIiwgXCJDYW5jZWxcIik7XHJcblxyXG4gICAgICAgICAgICBsZXQgc3VibWl0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpO1xyXG4gICAgICAgICAgICBzdWJtaXQuc2V0QXR0cmlidXRlKFwidHlwZVwiLCBcInN1Ym1pdFwiKTtcclxuICAgICAgICAgICAgc3VibWl0LnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwibmVzLWJ0biBpcy1zdWNjZXNzXCIpO1xyXG4gICAgICAgICAgICBzdWJtaXQuc2V0QXR0cmlidXRlKFwidmFsdWVcIiwgXCJTdWJtaXRcIik7XHJcblxyXG4gICAgICAgICAgICBmb3JtLmFwcGVuZENoaWxkKHJlc2V0YnV0dG9uKTtcclxuICAgICAgICAgICAgZm9ybS5hcHBlbmRDaGlsZChzdWJtaXQpO1xyXG4gICAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5yYWRpb19maXJlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLnVwZGF0ZUZvcm0odGhpcy5jb250cm9sbGVyKSk7XHJcbiAgfVxyXG5cclxuICAvLyBzZXRFdmVudHMoKSB7XHJcbiAgLy8gICAvL2V2ZW50c1xyXG4gIC8vICAgdGhpcy5yYWRpb19maXJlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbigpIHtcclxuICAvLyAgICAgaWYgKHRoaXMuY2hlY2tlZCkge1xyXG4gIC8vICAgICAgIGxldCBmaXJldGVtcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZmlyZV90ZW1wbGF0ZVwiKTtcclxuICAvLyAgICAgICBmaXJldGVtcC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG4gIC8vICAgICAgIGZpcmV0ZW1wLmNoaWxkTm9kZXNbMV0uc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJtb25zdGVyX2Zvcm1cIik7XHJcbiAgLy8gICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ3YXRlcl90ZW1wbGF0ZVwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgLy8gICAgICAgZG9jdW1lbnRcclxuICAvLyAgICAgICAgIC5nZXRFbGVtZW50QnlJZChcIndhdGVyX3RlbXBsYXRlXCIpXHJcbiAgLy8gICAgICAgICAuY2hpbGROb2Rlc1sxXS5yZW1vdmVBdHRyaWJ1dGUoXCJpZFwiKTtcclxuICAvLyAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVhcnRoX3RlbXBsYXRlXCIpLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAvLyAgICAgICBkb2N1bWVudFxyXG4gIC8vICAgICAgICAgLmdldEVsZW1lbnRCeUlkKFwiZWFydGhfdGVtcGxhdGVcIilcclxuICAvLyAgICAgICAgIC5jaGlsZE5vZGVzWzFdLnJlbW92ZUF0dHJpYnV0ZShcImlkXCIpO1xyXG4gIC8vICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwid2luZF90ZW1wbGF0ZVwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgLy8gICAgICAgZG9jdW1lbnRcclxuICAvLyAgICAgICAgIC5nZXRFbGVtZW50QnlJZChcIndpbmRfdGVtcGxhdGVcIilcclxuICAvLyAgICAgICAgIC5jaGlsZE5vZGVzWzFdLnJlbW92ZUF0dHJpYnV0ZShcImlkXCIpO1xyXG4gIC8vICAgICB9XHJcbiAgLy8gICB9KTtcclxuXHJcbiAgLy8gICB0aGlzLnJhZGlvX2ZpcmUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMudXBkYXRlRm9ybSh0aGlzLmNvbnRyb2xsZXIpKTtcclxuXHJcbiAgLy8gICB0aGlzLnJhZGlvX3dhdGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbigpIHtcclxuICAvLyAgICAgbGV0IHdhdGVydGVtcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwid2F0ZXJfdGVtcGxhdGVcIik7XHJcbiAgLy8gICAgIHdhdGVydGVtcC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG4gIC8vICAgICB3YXRlcnRlbXAuY2hpbGROb2Rlc1sxXS5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBcIm1vbnN0ZXJfZm9ybVwiKTtcclxuICAvLyAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJmaXJlX3RlbXBsYXRlXCIpLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAvLyAgICAgZG9jdW1lbnRcclxuICAvLyAgICAgICAuZ2V0RWxlbWVudEJ5SWQoXCJmaXJlX3RlbXBsYXRlXCIpXHJcbiAgLy8gICAgICAgLmNoaWxkTm9kZXNbMV0ucmVtb3ZlQXR0cmlidXRlKFwiaWRcIik7XHJcbiAgLy8gICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZWFydGhfdGVtcGxhdGVcIikuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gIC8vICAgICBkb2N1bWVudFxyXG4gIC8vICAgICAgIC5nZXRFbGVtZW50QnlJZChcImVhcnRoX3RlbXBsYXRlXCIpXHJcbiAgLy8gICAgICAgLmNoaWxkTm9kZXNbMV0ucmVtb3ZlQXR0cmlidXRlKFwiaWRcIik7XHJcbiAgLy8gICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwid2luZF90ZW1wbGF0ZVwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgLy8gICAgIGRvY3VtZW50XHJcbiAgLy8gICAgICAgLmdldEVsZW1lbnRCeUlkKFwid2luZF90ZW1wbGF0ZVwiKVxyXG4gIC8vICAgICAgIC5jaGlsZE5vZGVzWzFdLnJlbW92ZUF0dHJpYnV0ZShcImlkXCIpO1xyXG4gIC8vICAgfSk7XHJcblxyXG4gIC8vICAgdGhpcy5yYWRpb193YXRlci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy51cGRhdGVGb3JtKHRoaXMuY29udHJvbGxlcikpO1xyXG5cclxuICAvLyAgIHRoaXMucmFkaW9fZWFydGguYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKCkge1xyXG4gIC8vICAgICBsZXQgZWFydGh0ZW1wID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJlYXJ0aF90ZW1wbGF0ZVwiKTtcclxuICAvLyAgICAgZWFydGh0ZW1wLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcbiAgLy8gICAgIGVhcnRodGVtcC5jaGlsZE5vZGVzWzFdLnNldEF0dHJpYnV0ZShcImlkXCIsIFwibW9uc3Rlcl9mb3JtXCIpO1xyXG4gIC8vICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImZpcmVfdGVtcGxhdGVcIikuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gIC8vICAgICBkb2N1bWVudFxyXG4gIC8vICAgICAgIC5nZXRFbGVtZW50QnlJZChcImZpcmVfdGVtcGxhdGVcIilcclxuICAvLyAgICAgICAuY2hpbGROb2Rlc1sxXS5yZW1vdmVBdHRyaWJ1dGUoXCJpZFwiKTtcclxuICAvLyAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ3YXRlcl90ZW1wbGF0ZVwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgLy8gICAgIGRvY3VtZW50XHJcbiAgLy8gICAgICAgLmdldEVsZW1lbnRCeUlkKFwid2F0ZXJfdGVtcGxhdGVcIilcclxuICAvLyAgICAgICAuY2hpbGROb2Rlc1sxXS5yZW1vdmVBdHRyaWJ1dGUoXCJpZFwiKTtcclxuICAvLyAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ3aW5kX3RlbXBsYXRlXCIpLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAvLyAgICAgZG9jdW1lbnRcclxuICAvLyAgICAgICAuZ2V0RWxlbWVudEJ5SWQoXCJ3aW5kX3RlbXBsYXRlXCIpXHJcbiAgLy8gICAgICAgLmNoaWxkTm9kZXNbMV0ucmVtb3ZlQXR0cmlidXRlKFwiaWRcIik7XHJcbiAgLy8gICB9KTtcclxuXHJcbiAgLy8gICB0aGlzLnJhZGlvX2VhcnRoLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLnVwZGF0ZUZvcm0odGhpcy5jb250cm9sbGVyKSk7XHJcblxyXG4gIC8vICAgdGhpcy5yYWRpb193aW5kLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbigpIHtcclxuICAvLyAgICAgbGV0IHdpbmR0ZW1wID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ3aW5kX3RlbXBsYXRlXCIpO1xyXG4gIC8vICAgICB3aW5kdGVtcC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG4gIC8vICAgICB3aW5kdGVtcC5jaGlsZE5vZGVzWzFdLnNldEF0dHJpYnV0ZShcImlkXCIsIFwibW9uc3Rlcl9mb3JtXCIpO1xyXG4gIC8vICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImZpcmVfdGVtcGxhdGVcIikuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gIC8vICAgICBkb2N1bWVudFxyXG4gIC8vICAgICAgIC5nZXRFbGVtZW50QnlJZChcImZpcmVfdGVtcGxhdGVcIilcclxuICAvLyAgICAgICAuY2hpbGROb2Rlc1sxXS5yZW1vdmVBdHRyaWJ1dGUoXCJpZFwiKTtcclxuICAvLyAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ3YXRlcl90ZW1wbGF0ZVwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgLy8gICAgIGRvY3VtZW50XHJcbiAgLy8gICAgICAgLmdldEVsZW1lbnRCeUlkKFwid2F0ZXJfdGVtcGxhdGVcIilcclxuICAvLyAgICAgICAuY2hpbGROb2Rlc1sxXS5yZW1vdmVBdHRyaWJ1dGUoXCJpZFwiKTtcclxuICAvLyAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJlYXJ0aF90ZW1wbGF0ZVwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgLy8gICAgIGRvY3VtZW50XHJcbiAgLy8gICAgICAgLmdldEVsZW1lbnRCeUlkKFwiZWFydGhfdGVtcGxhdGVcIilcclxuICAvLyAgICAgICAuY2hpbGROb2Rlc1sxXS5yZW1vdmVBdHRyaWJ1dGUoXCJpZFwiKTtcclxuICAvLyAgIH0pO1xyXG5cclxuICAvLyAgIHRoaXMucmFkaW9fd2luZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy51cGRhdGVGb3JtKHRoaXMuY29udHJvbGxlcikpO1xyXG4gIC8vIH1cclxufVxyXG4iLCJleHBvcnQgY2xhc3MgTWFwVmlldyB7XHJcbiAgY29uc3RydWN0b3Ioem9vY29udHJvbGxlciwgd2VhdGhlcmNvbnRyb2xsZXIpIHtcclxuICAgIHRoaXMubWFwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtYXBcIik7XHJcbiAgICB0aGlzLnJlbW92ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmVtb3ZlXCIpO1xyXG5cclxuICAgIHRoaXMuem9vY29udHJvbGxlciA9IHpvb2NvbnRyb2xsZXI7XHJcbiAgICB0aGlzLndlYXRoZXJjb250cm9sbGVyID0gd2VhdGhlcmNvbnRyb2xsZXI7XHJcblxyXG4gICAgLy8gWm9vIHdpZHRoICh6dykgYW5kIHpvbyBoZWlnaHQgKHpoKVxyXG5cclxuICAgIHRoaXMuencgPSAxMDtcclxuICAgIHRoaXMuemggPSAxMDtcclxuXHJcbiAgICAvLyBMb2FkIGJ1dHRvbnMgZnJvbSBpbmRleC5odG1sXHJcblxyXG4gICAgbGV0IGp1bmdsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwianVuZ2xlXCIpO1xyXG4gICAgbGV0IGRlc2VydCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZGVzZXJ0XCIpO1xyXG4gICAgbGV0IG5vcnRocG9sZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibm9ydGhwb2xlXCIpO1xyXG5cclxuICAgIGp1bmdsZS5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICBqdW5nbGUuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJuZXMtYnRuIGlzLWRpc2FibGVkXCIpO1xyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gQnV0dG9ucyBmb3Igc3dpdGNoaW5nIGJldHdlZW4gZW52aXJvbm1lbnRzXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBqdW5nbGUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgaWYgKGp1bmdsZS5kaXNhYmxlZCAhPSB0cnVlKSB7XHJcbiAgICAgICAgdGhpcy5sb2FkR3JpZCgwKTtcclxuICAgICAgICBqdW5nbGUuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgIGRlc2VydC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgIG5vcnRocG9sZS5kaXNhYmxlZCA9IGZhbHNlO1xyXG5cclxuICAgICAgICBqdW5nbGUuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJuZXMtYnRuIGlzLWRpc2FibGVkXCIpO1xyXG4gICAgICAgIGRlc2VydC5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcIm5lcy1idG4gaXMtd2FybmluZ1wiKTtcclxuICAgICAgICBub3J0aHBvbGUuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJuZXMtYnRuXCIpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNlcnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgaWYgKGRlc2VydC5kaXNhYmxlZCAhPSB0cnVlKSB7XHJcbiAgICAgICAgdGhpcy5sb2FkR3JpZCgyKTtcclxuICAgICAgICBkZXNlcnQuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgIGp1bmdsZS5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgIG5vcnRocG9sZS5kaXNhYmxlZCA9IGZhbHNlO1xyXG5cclxuICAgICAgICBkZXNlcnQuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJuZXMtYnRuIGlzLWRpc2FibGVkXCIpO1xyXG4gICAgICAgIGp1bmdsZS5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcIm5lcy1idG4gaXMtc3VjY2Vzc1wiKTtcclxuICAgICAgICBub3J0aHBvbGUuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJuZXMtYnRuXCIpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBub3J0aHBvbGUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgaWYgKG5vcnRocG9sZS5kaXNhYmxlZCAhPSB0cnVlKSB7XHJcbiAgICAgICAgdGhpcy5sb2FkR3JpZCgxKTtcclxuICAgICAgICBub3J0aHBvbGUuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgIGRlc2VydC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgICAgIGp1bmdsZS5kaXNhYmxlZCA9IGZhbHNlO1xyXG5cclxuICAgICAgICBub3J0aHBvbGUuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJuZXMtYnRuIGlzLWRpc2FibGVkXCIpO1xyXG4gICAgICAgIGp1bmdsZS5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcIm5lcy1idG4gaXMtc3VjY2Vzc1wiKTtcclxuICAgICAgICBkZXNlcnQuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJuZXMtYnRuIGlzLXdhcm5pbmdcIik7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIC8vIEluaXRpYWxpc2UgdGhlIG1hcCBmcm9tIGp1bmdsZVxyXG4gICAgdGhpcy5sb2FkR3JpZCgwKTtcclxuICB9XHJcblxyXG4gIGxvYWRHcmlkKHRlcnJhaW4pIHtcclxuICAgIC8vIFRlcnJhaW4gaW5kZXg6IDAgaXMganVuZ2xlLCAxIGlzIG5vcnRocG9sZSwgMyBpcyBkZXNlcnRcclxuICAgIHRoaXMudGVycmFpbiA9IHRlcnJhaW47XHJcbiAgICB0aGlzLnpvb2NvbnRyb2xsZXIubG9hZEdyaWQodGhpcyk7XHJcbiAgfVxyXG5cclxuICBwYWludEdyaWQoZ3JpZCkge1xyXG4gICAgdGhpcy5ncmlkID0gZ3JpZDtcclxuICAgIHRoaXMuc2VsZWN0ZWQgPSB0aGlzLmdyaWRbdGhpcy50ZXJyYWluXS5ncmlkO1xyXG4gICAgdGhpcy53ZWF0aGVyY29udHJvbGxlci51cGRhdGVXZWF0aGVyKFxyXG4gICAgICB0aGlzLmdyaWRbdGhpcy50ZXJyYWluXS5yZWZlcmVuY2VfY2l0eVxyXG4gICAgKTtcclxuICAgIHRoaXMuaW5pdFJlbW92ZSgpO1xyXG4gICAgdGhpcy5kcmF3Qm9hcmQoKTtcclxuICB9XHJcblxyXG4gIGRyYXdCb2FyZCgpIHtcclxuICAgIGxldCBvbGRCb2FyZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZ3JpZFwiKTtcclxuICAgIGlmIChvbGRCb2FyZCAhPSBudWxsKSB7XHJcbiAgICAgIG9sZEJvYXJkLnJlbW92ZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMudGFibGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGFibGVcIik7XHJcbiAgICB0aGlzLnRhYmxlLnNldEF0dHJpYnV0ZShcImlkXCIsIFwiZ3JpZFwiKTtcclxuXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuenc7IGkrKykge1xyXG4gICAgICB0aGlzLnRyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRyXCIpO1xyXG4gICAgICBmb3IgKGxldCB5ID0gMDsgeSA8IHRoaXMuemg7IHkrKykge1xyXG4gICAgICAgIHRoaXMudGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGRcIik7XHJcblxyXG4gICAgICAgIC8vIERyYWcgYW5kIGRyb3AgZXZlbnRzXHJcbiAgICAgICAgdGhpcy50ZC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ292ZXJcIiwgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLnRkLmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnZW50ZXJcIiwgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBsZXQgZ3JpZCA9IHRoaXMuZ3JpZDtcclxuICAgICAgICBsZXQgdGVycmFpbiA9IHRoaXMudGVycmFpbjtcclxuICAgICAgICBsZXQgem9vY29udHJvbGxlciA9IHRoaXMuem9vY29udHJvbGxlcjtcclxuXHJcbiAgICAgICAgdGhpcy50ZC5hZGRFdmVudExpc3RlbmVyKFwiZHJvcFwiLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICBsZXQgZGF0YSA9IGUuZGF0YVRyYW5zZmVyLmdldERhdGEoXCJUZXh0XCIpO1xyXG4gICAgICAgICAgbGV0IG1vbnN0ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChkYXRhKTtcclxuXHJcbiAgICAgICAgICBpZiAobW9uc3RlciAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAhdGhpcy5oYXNDaGlsZE5vZGVzKCkgJiZcclxuICAgICAgICAgICAgICBtb25zdGVyLmdldEF0dHJpYnV0ZShcImRyYWdnYWJsZVwiKSA9PT0gXCJ0cnVlXCJcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgbGV0IG9yaWdpbiA9IG1vbnN0ZXIuZ2V0QXR0cmlidXRlKFwiaWRcIikuc3BsaXQoXCJ4XCIpO1xyXG4gICAgICAgICAgICAgIGxldCBjb29yZGlkID0gdGhpcy5nZXRBdHRyaWJ1dGUoXCJpZFwiKS5zcGxpdChcIi1cIik7XHJcblxyXG4gICAgICAgICAgICAgIHpvb2NvbnRyb2xsZXIuYWRkTW9uc3RlclRvR3JpZChcclxuICAgICAgICAgICAgICAgIGdyaWQsXHJcbiAgICAgICAgICAgICAgICB0ZXJyYWluLFxyXG4gICAgICAgICAgICAgICAgY29vcmRpZFswXSxcclxuICAgICAgICAgICAgICAgIGNvb3JkaWRbMV1cclxuICAgICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgICBpZiAobW9uc3Rlci5nZXRBdHRyaWJ1dGUoXCJpZFwiKSAhPT0gXCItMXgtMVwiKSB7XHJcbiAgICAgICAgICAgICAgICB6b29jb250cm9sbGVyLmRlbGV0ZU1vbnN0ZXJGcm9tR3JpZChcclxuICAgICAgICAgICAgICAgICAgZ3JpZCxcclxuICAgICAgICAgICAgICAgICAgdGVycmFpbixcclxuICAgICAgICAgICAgICAgICAgb3JpZ2luWzBdLFxyXG4gICAgICAgICAgICAgICAgICBvcmlnaW5bMV1cclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICBtb25zdGVyLnNldEF0dHJpYnV0ZShcImlkXCIsIGNvb3JkaWRbMF0gKyBcInhcIiArIGNvb3JkaWRbMV0pO1xyXG4gICAgICAgICAgICAgIHRoaXMuYXBwZW5kKG1vbnN0ZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMudGQuc2V0QXR0cmlidXRlKFwiaWRcIiwgaSArIFwiLVwiICsgeSk7XHJcblxyXG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5zZWxlY3RlZFtpXS5Db2x1bW5zW3ldID09PSBcIm9iamVjdFwiKSB7XHJcbiAgICAgICAgICBsZXQgbW9uc3RlciA9IHRoaXMuc2VsZWN0ZWRbaV0uQ29sdW1uc1t5XTtcclxuICAgICAgICAgIHRoaXMuaW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImltZ1wiKTtcclxuICAgICAgICAgIHRoaXMuaW1nLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwibW9uc3RlclwiKTtcclxuXHJcbiAgICAgICAgICAvL0V2ZXJ5IG1vbnN0ZXIgZ2V0cyBhbiBpZCBiYXNlZCBvbiB0aGVpciBjb29yZGluYXRlc1xyXG4gICAgICAgICAgdGhpcy5pbWcuc2V0QXR0cmlidXRlKFwiaWRcIiwgaSArIFwieFwiICsgeSk7XHJcblxyXG4gICAgICAgICAgc3dpdGNoIChtb25zdGVyLmVsZW1lbnQpIHtcclxuICAgICAgICAgICAgY2FzZSBcImZpcmVcIjpcclxuICAgICAgICAgICAgICB0aGlzLmltZy5zcmMgPSBcIi4uL3NyYy9SZXNvdXJjZXMvb3JhbmdlbW9uc3Rlci5wbmdcIjtcclxuICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBcIndhdGVyXCI6XHJcbiAgICAgICAgICAgICAgdGhpcy5pbWcuc3JjID0gXCIuLi9zcmMvUmVzb3VyY2VzL2JsdWVtb25zdGVyLnBuZ1wiO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwiZWFydGhcIjpcclxuICAgICAgICAgICAgICB0aGlzLmltZy5zcmMgPSBcIi4uL3NyYy9SZXNvdXJjZXMvYnJvd25tb25zdGVyLnBuZ1wiO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFwid2luZFwiOlxyXG4gICAgICAgICAgICAgIHRoaXMuaW1nLnNyYyA9IFwiLi4vc3JjL1Jlc291cmNlcy93aGl0ZW1vbnN0ZXIucG5nXCI7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgIGFsZXJ0KFwiV2FybmluZzogY291bGQgbm90IGZpbmQgcmVzb3VyY2UgZm9yIG1vbnN0ZXJcIik7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgdGhpcy5pbWcuZHJhZ2dhYmxlID0gdHJ1ZTtcclxuICAgICAgICAgIHRoaXMuaW1nLmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnc3RhcnRcIiwgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICBlLmRhdGFUcmFuc2Zlci5zZXREYXRhKFwiVGV4dFwiLCBlLnRhcmdldC5pZCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIHRoaXMudGQuYXBwZW5kQ2hpbGQodGhpcy5pbWcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRbaV0uQ29sdW1uc1t5XSA9PSAxKSB7XHJcbiAgICAgICAgICB0aGlzLmltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbWdcIik7XHJcbiAgICAgICAgICB0aGlzLmltZy5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcInN0b25lXCIpO1xyXG5cclxuICAgICAgICAgIC8vRXZlcnkgbW9uc3RlciBnZXRzIGFuIGlkIGJhc2VkIG9uIHRoZWlyIGNvb3JkaW5hdGVzXHJcbiAgICAgICAgICB0aGlzLmltZy5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBpICsgXCJ4XCIgKyB5KTtcclxuXHJcbiAgICAgICAgICBzd2l0Y2ggKHRlcnJhaW4pIHtcclxuICAgICAgICAgICAgLy8gSnVuZ2xlXHJcbiAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICB0aGlzLmltZy5zcmMgPSBcIi4uL3NyYy9SZXNvdXJjZXMvanVuZ2xlcm9jay5wbmdcIjtcclxuICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1hcFwiKS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcIiMyODkxNTBcIjtcclxuICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgIC8vIE5vcnRwb2xlXHJcbiAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICB0aGlzLmltZy5zcmMgPSBcIi4uL3NyYy9SZXNvdXJjZXMvaWNlY2h1bmsucG5nXCI7XHJcbiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtYXBcIikuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjRDhGRkZGXCI7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAvLyBEZXNlcnRcclxuICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgIHRoaXMuaW1nLnNyYyA9IFwiLi4vc3JjL1Jlc291cmNlcy9jYWN0dXMucG5nXCI7XHJcbiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtYXBcIikuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjRURDOUFGXCI7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhpcy50ZC5hcHBlbmRDaGlsZCh0aGlzLmltZyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMudHIuYXBwZW5kQ2hpbGQodGhpcy50ZCk7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy50YWJsZS5hcHBlbmRDaGlsZCh0aGlzLnRyKTtcclxuICAgIH1cclxuICAgIHRoaXMubWFwLmFwcGVuZENoaWxkKHRoaXMudGFibGUpO1xyXG4gIH1cclxuXHJcbiAgaW5pdFJlbW92ZSgpIHtcclxuICAgIGxldCBncmlkID0gdGhpcy5ncmlkO1xyXG4gICAgbGV0IHRlcnJhaW4gPSB0aGlzLnRlcnJhaW47XHJcbiAgICBsZXQgem9vY29udHJvbGxlciA9IHRoaXMuem9vY29udHJvbGxlcjtcclxuXHJcbiAgICB0aGlzLnJlbW92ZS5hZGRFdmVudExpc3RlbmVyKFwiZHJvcFwiLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIGxldCBkYXRhID0gZS5kYXRhVHJhbnNmZXIuZ2V0RGF0YShcIlRleHRcIik7XHJcbiAgICAgIGxldCBtb25zdGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZGF0YSk7XHJcbiAgICAgIGlmIChtb25zdGVyICE9IG51bGwpIHtcclxuICAgICAgICBsZXQgb3JpZ2luID0gbW9uc3Rlci5nZXRBdHRyaWJ1dGUoXCJpZFwiKS5zcGxpdChcInhcIik7XHJcblxyXG4gICAgICAgIHpvb2NvbnRyb2xsZXIuZGVsZXRlTW9uc3RlckZyb21HcmlkKFxyXG4gICAgICAgICAgZ3JpZCxcclxuICAgICAgICAgIHRlcnJhaW4sXHJcbiAgICAgICAgICBvcmlnaW5bMF0sXHJcbiAgICAgICAgICBvcmlnaW5bMV1cclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBtb25zdGVyLnJlbW92ZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLnJlbW92ZS5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ292ZXJcIiwgZnVuY3Rpb24oZSkge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLnJlbW92ZS5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ2VudGVyXCIsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBjbGFzcyBXZWF0aGVyRGF0YVNlcnZpY2Uge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMuYXBpa2V5ID0gJzZlZmMzNWMzYzI2MTFlNDE0ZWE2NmRhNzZiMmUzZjBiJztcclxuICAgICAgICB0aGlzLnVuaXRzID0gJ21ldHJpYyc7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Q3VycmVudFdlYXRoZXIoY2l0eU5hbWUpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYGh0dHA6Ly9hcGkub3BlbndlYXRoZXJtYXAub3JnL2RhdGEvMi41L3dlYXRoZXI/cT0ke2NpdHlOYW1lfSZhcHBpZD0ke3RoaXMuYXBpa2V5fSZ1bml0cz0ke3RoaXMudW5pdHN9YClcclxuICAgICAgICAudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKG15SnNvbikge1xyXG4gICAgICAgICAgcmV0dXJuIG15SnNvbjtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG59IiwiZXhwb3J0IGNsYXNzIFdlYXRoZXJWaWV3IHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLmltZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3ZWF0aGVyaW1nJyk7XHJcbiAgICAgICAgdGhpcy50ZW1wID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RlbXAnKTtcclxuICAgICAgICB0aGlzLnJhaW4gPSBmYWxzZTtcclxuXHJcbiAgICAgICAgdGhpcy5pbml0UmFpblN3aXRjaCgpO1xyXG4gICAgfVxyXG5cclxuICAgIGluaXRSYWluU3dpdGNoKCkge1xyXG4gICAgICAgIGxldCByYWluc3dpdGNoID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JhaW5zd2l0Y2gnKTtcclxuICAgICAgICBsZXQgb3duY2xhc3MgPSB0aGlzO1xyXG4gICAgICAgIHJhaW5zd2l0Y2guYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBpZihvd25jbGFzcy5yYWluKSB7XHJcbiAgICAgICAgICAgICAgICBvd25jbGFzcy51cGRhdGVXZWF0aGVyKG93bmNsYXNzLnRlbXBlcmF0dXJlLCBcIkNsZWFyXCIpO1xyXG4gICAgICAgICAgICAgICAgb3duY2xhc3MucmFpbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgb3duY2xhc3MudXBkYXRlV2VhdGhlcihvd25jbGFzcy50ZW1wZXJhdHVyZSwgXCJSYWluXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlV2VhdGhlcih0ZW1wLCByYWluKSB7XHJcbiAgICAgICAgdGhpcy50ZW1wZXJhdHVyZSA9IHRlbXA7XHJcbiAgICAgICAgdGhpcy50ZW1wLmlubmVyVGV4dCA9IGAke3RlbXB9wrAgQ2VsY2l1c2A7XHJcblxyXG5cclxuICAgICAgICBpZihyYWluID09PSAnUmFpbicgfHwgcmFpbiA9PT0gJ1Nob3dlciByYWluJykge1xyXG4gICAgICAgICAgICB0aGlzLnJhaW4gPSB0cnVlO1xyXG4gICAgICAgICAgICBpZihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmFpbicpID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMuc2V0QXR0cmlidXRlKCdpZCcsICdyYWluJyk7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwJykuYXBwZW5kQ2hpbGQoY2FudmFzKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RhcnRSYWluKDMwMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBsZXQgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JhaW4nKTtcclxuICAgICAgICAgICAgaWYoY2FudmFzICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBjYW52YXMucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChjYW52YXMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHN0YXJ0UmFpbihtYXhQYXJ0cykge1xyXG4gICAgICAgIGxldCBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJhaW5cIik7XHJcblxyXG4gICAgICAgIGlmIChjYW52YXMuZ2V0Q29udGV4dCkge1xyXG4gICAgICAgICAgICBsZXQgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7XHJcbiAgICAgICAgICAgIGxldCB3ID0gY2FudmFzLndpZHRoO1xyXG4gICAgICAgICAgICBsZXQgaCA9IGNhbnZhcy5oZWlnaHQ7XHJcbiAgICAgICAgICAgIGN0eC5zdHJva2VTdHlsZSA9ICdyZ2JhKDQ2LDg2LDE0NywwLjMpJztcclxuICAgICAgICAgICAgY3R4LmxpbmVXaWR0aCA9IDAuNztcclxuICAgICAgICAgICAgY3R4LmxpbmVDYXAgPSAncm91bmQnO1xyXG5cclxuXHJcbiAgICAgICAgICAgIGxldCBpbml0ID0gW107XHJcbiAgICAgICAgICAgIGZvciAobGV0IGEgPSAwOyBhIDwgbWF4UGFydHM7IGErKykge1xyXG4gICAgICAgICAgICAgICAgaW5pdC5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICB4OiBNYXRoLnJhbmRvbSgpICogdyxcclxuICAgICAgICAgICAgICAgICAgICB5OiBNYXRoLnJhbmRvbSgpICogaCxcclxuICAgICAgICAgICAgICAgICAgICBsOiBNYXRoLnJhbmRvbSgpICogMSxcclxuICAgICAgICAgICAgICAgICAgICB4czogLTQgKyBNYXRoLnJhbmRvbSgpICogNCArIDIsXHJcbiAgICAgICAgICAgICAgICAgICAgeXM6IE1hdGgucmFuZG9tKCkgKiAxMCArIDEwXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBsZXQgcGFydGljbGVzID0gW107XHJcbiAgICAgICAgICAgIGZvciAobGV0IGIgPSAwOyBiIDwgbWF4UGFydHM7IGIrKykge1xyXG4gICAgICAgICAgICAgICAgcGFydGljbGVzW2JdID0gaW5pdFtiXTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gZHJhdygpIHtcclxuICAgICAgICAgICAgICAgIGN0eC5jbGVhclJlY3QoMCwgMCwgdywgaCk7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBjID0gMDsgYyA8IHBhcnRpY2xlcy5sZW5ndGg7IGMrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBwID0gcGFydGljbGVzW2NdO1xyXG4gICAgICAgICAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgICAgICAgICBjdHgubW92ZVRvKHAueCwgcC55KTtcclxuICAgICAgICAgICAgICAgICAgICBjdHgubGluZVRvKHAueCArIHAubCAqIHAueHMsIHAueSArIHAubCAqIHAueXMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGN0eC5zdHJva2UoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIG1vdmUoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gbW92ZSgpIHtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGIgPSAwOyBiIDwgcGFydGljbGVzLmxlbmd0aDsgYisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHAgPSBwYXJ0aWNsZXNbYl07XHJcbiAgICAgICAgICAgICAgICAgICAgcC54ICs9IHAueHM7XHJcbiAgICAgICAgICAgICAgICAgICAgcC55ICs9IHAueXM7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHAueCA+IHcgfHwgcC55ID4gaCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwLnggPSBNYXRoLnJhbmRvbSgpICogdztcclxuICAgICAgICAgICAgICAgICAgICAgICAgcC55ID0gLTIwO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2V0SW50ZXJ2YWwoZHJhdywgODApO1xyXG5cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBXZWF0aGVyRGF0YVNlcnZpY2UgfSBmcm9tIFwiLi4vTW9kZWwvV2VhdGhlckRhdGFTZXJ2aWNlXCI7XHJcbmltcG9ydCB7IFdlYXRoZXJWaWV3IH0gZnJvbSBcIi4uL1ZpZXcvV2VhdGhlclZpZXdcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBXZWF0aGVyQ29udHJvbGxlciB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLndlYXRoZXJkYXRhID0gbmV3IFdlYXRoZXJEYXRhU2VydmljZSgpO1xyXG4gICAgICAgIHRoaXMud2VhdGhlcnZpZXcgPSBuZXcgV2VhdGhlclZpZXcoKTtcclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVXZWF0aGVyKGNpdHkpIHtcclxuICAgICAgICBsZXQgd2VhdGhlcnZpZXcgPSB0aGlzLndlYXRoZXJ2aWV3O1xyXG4gICAgICAgIHRoaXMud2VhdGhlcmRhdGEuZ2V0Q3VycmVudFdlYXRoZXIoY2l0eSkudGhlbihmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHdlYXRoZXJ2aWV3LnVwZGF0ZVdlYXRoZXIoZGF0YS5tYWluLnRlbXAsIGRhdGEud2VhdGhlclswXS5tYWluKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufSIsImV4cG9ydCBjbGFzcyBNYXBTZXJ2aWNlIHtcclxuICBsb2FkR3JpZCgpIHtcclxuICAgIHJldHVybiBmZXRjaChcIi4vbWFwL2dyaWQuanNvblwiKVxyXG4gICAgICAudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC50aGVuKGZ1bmN0aW9uKGdyaWQpIHtcclxuICAgICAgICBsZXQgU1RPUkFHRV9LRVkgPSBcInpvby1ncmlkXCI7XHJcblxyXG4gICAgICAgIC8vIFB1dCB0aGUgd2hvbGUgZ3JpZCBmcm9tIGxvY2Fsc3RvcmFnZSBpbiBhIHZhcmlhYmxlXHJcbiAgICAgICAgbGV0IHN0b3JhZ2UgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFNUT1JBR0VfS0VZKSk7XHJcblxyXG4gICAgICAgIGlmIChzdG9yYWdlICE9IG51bGwpIHtcclxuICAgICAgICAgIGdyaWQgPSBzdG9yYWdlO1xyXG5cclxuICAgICAgICAvLyBJZiB0aGUgZ3JpZCBpcyBub3QgcHJlc2VudCBpbiBsb2NhbHN0b3JhZ2UgeWV0LCBwdXQgdGhlIHdob2xlIGdyaWQgYXMgbG9hZGVkIGZyb20gdGhlIGxvY2FsIGdyaWQuanNvbiBmaWxlIGluIHRoZXJlXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFNUT1JBR0VfS0VZLCBKU09OLnN0cmluZ2lmeShncmlkKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZ3JpZDtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRNb25zdGVyVG9HcmlkKGdyaWQsIHRlcnJhaW4sIG1vbnN0ZXIsIHgsIHkpIHtcclxuICAgIG1vbnN0ZXIueCA9IHg7XHJcbiAgICBtb25zdGVyLnkgPSB5O1xyXG4gICAgbW9uc3Rlci5tYXAgPSB0ZXJyYWluO1xyXG4gICAgZ3JpZFt0ZXJyYWluXS5ncmlkW3hdLkNvbHVtbnNbeV0gPSBtb25zdGVyO1xyXG4gICAgdGhpcy5zYXZlVG9Mb2NhbFN0b3JhZ2UoZ3JpZCk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVNb25zdGVyRnJvbUdyaWQoZ3JpZCwgdGVycmFpbiwgeCwgeSkge1xyXG4gICAgZ3JpZFt0ZXJyYWluXS5ncmlkW3hdLkNvbHVtbnNbeV0gPSBcIjBcIjtcclxuICAgIHRoaXMuc2F2ZVRvTG9jYWxTdG9yYWdlKGdyaWQpO1xyXG4gIH1cclxuXHJcbiAgc2F2ZVRvTG9jYWxTdG9yYWdlKGdyaWQpIHtcclxuICAgIGxldCBTVE9SQUdFX0tFWSA9IFwiem9vLWdyaWRcIjtcclxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFNUT1JBR0VfS0VZLCBKU09OLnN0cmluZ2lmeShncmlkKSk7XHJcbiAgfVxyXG5cclxufVxyXG4iLCJpbXBvcnQgeyBNb25zdGVyU2VydmljZSB9IGZyb20gJy4uL21vZGVsL01vbnN0ZXJTZXJ2aWNlJ1xyXG5pbXBvcnQgeyBDcmVhdGVNb25zdGVyVmlldyB9IGZyb20gJy4uL3ZpZXcvQ3JlYXRlTW9uc3RlclZpZXcnO1xyXG5pbXBvcnQgeyBNYXBWaWV3IH0gZnJvbSAnLi4vdmlldy9NYXBWaWV3JztcclxuaW1wb3J0IHsgV2VhdGhlckNvbnRyb2xsZXIgfSBmcm9tICcuL1dlYXRoZXJDb250cm9sbGVyJztcclxuaW1wb3J0IHsgTWFwU2VydmljZSB9IGZyb20gJy4uL01vZGVsL01hcFNlcnZpY2UnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgWm9vQ29udHJvbGxlclxyXG57XHJcbiAgICAvL2VsIGNvbnN0cnVjdG9yXHJcbiAgICBjb25zdHJ1Y3Rvcigpe1xyXG4gICAgICAgIHRoaXMud2VhdGhlcmNvbnRyb2xsZXIgPSBuZXcgV2VhdGhlckNvbnRyb2xsZXIoKTtcclxuXHJcbiAgICAgICAgdGhpcy5tb25zdGVyc2VydmljZSA9IG5ldyBNb25zdGVyU2VydmljZSgpO1xyXG4gICAgICAgIHRoaXMuY3JlYXRlbW9uc3RlcnZpZXcgPSAgbmV3IENyZWF0ZU1vbnN0ZXJWaWV3KHRoaXMpO1xyXG4gICAgICAgIHRoaXMubWFwc2VydmljZSA9IG5ldyBNYXBTZXJ2aWNlKCk7XHJcblxyXG4gICAgICAgIHRoaXMubWFwdmlldyA9IG5ldyBNYXBWaWV3KHRoaXMsIHRoaXMud2VhdGhlcmNvbnRyb2xsZXIpO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZE1vbnN0ZXJUb0dyaWQoZ3JpZCwgdGVycmFpbiwgeCwgeSkge1xyXG4gICAgICAgIHRoaXMubWFwc2VydmljZS5hZGRNb25zdGVyVG9HcmlkKGdyaWQsIHRlcnJhaW4sIHRoaXMuZ2V0TGFzdE1vbnN0ZXIoKSwgeCwgeSk7XHJcbiAgICB9XHJcblxyXG4gICAgZGVsZXRlTW9uc3RlckZyb21HcmlkKGdyaWQsIHRlcnJhaW4sIHgsIHkpIHtcclxuICAgICAgICB0aGlzLm1hcHNlcnZpY2UuZGVsZXRlTW9uc3RlckZyb21HcmlkKGdyaWQsIHRlcnJhaW4sIHgsIHkpO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZE1vbnN0ZXIobmFtZSwgZWxlbWVudCwgYXJtcywgdHlwZWFybXMsIGxlZ3MsIGV5ZXMsIGZ1cnR5cGUsIGZseSwgc3dpbSwgY29sb3VyLCBtYXAsIHgsIHkpe1xyXG4gICAgICAgIHRoaXMubW9uc3RlcnNlcnZpY2Uuc2F2ZU1vbnN0ZXIobmFtZSwgZWxlbWVudCwgYXJtcywgdHlwZWFybXMsIGxlZ3MsIGV5ZXMsIGZ1cnR5cGUsIGZseSwgc3dpbSwgY29sb3VyLCBtYXAsIHgsIHkpO1xyXG4gICAgfVxyXG5cclxuICAgIGxvYWRHcmlkKG1hcHZpZXcpIHtcclxuICAgICAgICB0aGlzLm1hcHNlcnZpY2UubG9hZEdyaWQoKS50aGVuKGZ1bmN0aW9uKGdyaWQpIHtcclxuICAgICAgICAgICAgbWFwdmlldy5wYWludEdyaWQoZ3JpZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0TGFzdE1vbnN0ZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubW9uc3RlcnNlcnZpY2UuZ2V0TGFzdE1vbnN0ZXIoKTtcclxuICAgIH1cclxufSIsImltcG9ydCBab29Db250cm9sbGVyIGZyb20gJy4vQ29udHJvbGxlci9ab29Db250cm9sbGVyJztcclxuXHJcbmxldCB6b29jb250cm9sbGVyID0gbmV3IFpvb0NvbnRyb2xsZXIoKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///0\n')}]);