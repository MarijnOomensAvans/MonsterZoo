!function(t){var n={};function c(e){if(n[e])return n[e].exports;var I=n[e]={i:e,l:!1,exports:{}};return t[e].call(I.exports,I,I.exports,c),I.l=!0,I.exports}c.m=t,c.c=n,c.d=function(t,n,e){c.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},c.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,n){if(1&n&&(t=c(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(c.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var I in t)c.d(e,I,function(n){return t[n]}.bind(null,I));return e},c.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return c.d(n,"a",n),n},c.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},c.p="",c(c.s=0)}([function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n\n// CONCATENATED MODULE: ./src/model/Monster.js\nclass Monster_Monster{\r\n    // MonsterData exists of element, name, arms, type_arms, legs, eyes, skintype, ability to fly, ability to swim, colour ,map, x coordinate, y coordinate\r\n    constructor(monsterdata){\r\n        Object.assign(this, monsterdata);\r\n    }\r\n}\r\n\r\n// class fireMonster extends Monster{\r\n\r\n// }\r\n// class waterfireMonster extends Monster{\r\n    \r\n// }\r\n// class earthMonster extends Monster{\r\n    \r\n// }\r\n// class windMonster extends Monster{\r\n    \r\n// }\n// CONCATENATED MODULE: ./src/model/MonsterService.js\n\r\n\r\n\r\nclass MonsterService_MonsterService\r\n{\r\n    constructor(){\r\n        this.monsters = [\r\n            new Monster_Monster(\'fire\', \'Marijn\', 2, \'tentacles\', 2, 4, \'scales\', false, false, \'orange\', 0, 1, 1)\r\n        ]\r\n    }\r\n\r\n    getMonsters()\r\n    {\r\n        return this.monsters;\r\n    }\r\n\r\n    saveMonster(monster){\r\n       this.monsters.push(monster);\r\n    }\r\n\r\n    getLastMonster() {\r\n        return this.monsters[this.monsters.length -1];\r\n    }\r\n}\r\n\n// CONCATENATED MODULE: ./src/view/CreateMonsterView.js\nclass CreateMonsterView {\r\n\r\n  constructor(controller) {\r\n    this.controller = controller;\r\n\r\n    this.template = document.getElementById("create_monster");\r\n\r\n    this.radio_fire = document.getElementById("element_fire");\r\n    this.radio_water = document.getElementById("element_water");\r\n    this.radio_earth = document.getElementById("element_earth");\r\n    this.radio_wind = document.getElementById("element_wind");\r\n    this.remove = document.getElementById("remove");\r\n\r\n    this.setEvents();\r\n  }\r\n\r\n  updateForm() {\r\n    this.monsterform = document.getElementById("monster_form");\r\n    let created = document.getElementById("created");\r\n\r\n    this.monsterform.addEventListener("submit", function(e) {\r\n      e.preventDefault();\r\n\r\n      if (created.hasChildNodes()) {\r\n        while (created.firstChild) {\r\n          created.removeChild(created.firstChild);\r\n        }\r\n      }\r\n      this.img = document.createElement("img");\r\n      this.img.setAttribute("class", "created");\r\n\r\n      let src = "";\r\n\r\n      switch (this.element.value) {\r\n        case "fire":\r\n          src = "../src/Resources/orangemonster.png";\r\n          break;\r\n        case "water":\r\n          src = "../src/Resources/bluemonster.png";\r\n          break;\r\n        case "earth":\r\n          src = "../src/Resources/brownmonster.png";\r\n          break;\r\n        case "wind":\r\n          src = "../src/Resources/whitemonster.png";\r\n          break;\r\n\r\n        default:\r\n          break;\r\n      }\r\n      this.img.src = src;\r\n      this.img.draggable = true;\r\n      this.img.setAttribute(\'id\', \'-1x-1\');\r\n      this.img.addEventListener("dragstart", function(e) {\r\n        e.dataTransfer.setData("Text", e.target.id);\r\n      });\r\n      created.appendChild(this.img);\r\n\r\n      controller.addMonster(this.name.value, this.element.value, this.arms.value, this.tentacles.value, this.legs.value, this.eyes.value, this.swimtype.value, this.fly.value, this.swim.value, this.colour.value, this.map.value, this.x.value, this.y.value);\r\n\r\n    });\r\n  }\r\n\r\n  setEvents() {\r\n    //events\r\n    this.radio_fire.addEventListener("click", function() {\r\n      if (this.checked) {\r\n        let firetemp = document.getElementById("fire_template");\r\n        firetemp.style.display = "block";\r\n        firetemp.childNodes[1].setAttribute("id", "monster_form");\r\n        document.getElementById("water_template").style.display = "none";\r\n        document\r\n          .getElementById("water_template")\r\n          .childNodes[1].removeAttribute("id");\r\n        document.getElementById("earth_template").style.display = "none";\r\n        document\r\n          .getElementById("earth_template")\r\n          .childNodes[1].removeAttribute("id");\r\n        document.getElementById("wind_template").style.display = "none";\r\n        document\r\n          .getElementById("wind_template")\r\n          .childNodes[1].removeAttribute("id");\r\n      }\r\n    });\r\n\r\n    this.radio_fire.addEventListener("click", this.updateForm);\r\n\r\n    this.radio_water.addEventListener("click", function() {\r\n      let watertemp = document.getElementById("water_template");\r\n      watertemp.style.display = "block";\r\n      watertemp.childNodes[1].setAttribute("id", "monster_form");\r\n      document.getElementById("fire_template").style.display = "none";\r\n      document\r\n        .getElementById("fire_template")\r\n        .childNodes[1].removeAttribute("id");\r\n      document.getElementById("earth_template").style.display = "none";\r\n      document\r\n        .getElementById("earth_template")\r\n        .childNodes[1].removeAttribute("id");\r\n      document.getElementById("wind_template").style.display = "none";\r\n      document\r\n        .getElementById("wind_template")\r\n        .childNodes[1].removeAttribute("id");\r\n    });\r\n\r\n    this.radio_water.addEventListener("click", this.updateForm);\r\n\r\n    this.radio_earth.addEventListener("click", function() {\r\n      let earthtemp = document.getElementById("earth_template");\r\n      earthtemp.style.display = "block";\r\n      earthtemp.childNodes[1].setAttribute("id", "monster_form");\r\n      document.getElementById("fire_template").style.display = "none";\r\n      document\r\n        .getElementById("fire_template")\r\n        .childNodes[1].removeAttribute("id");\r\n      document.getElementById("water_template").style.display = "none";\r\n      document\r\n        .getElementById("water_template")\r\n        .childNodes[1].removeAttribute("id");\r\n      document.getElementById("wind_template").style.display = "none";\r\n      document\r\n        .getElementById("wind_template")\r\n        .childNodes[1].removeAttribute("id");\r\n    });\r\n\r\n    this.radio_earth.addEventListener("click", this.updateForm);\r\n\r\n    this.radio_wind.addEventListener("click", function() {\r\n      let windtemp = document.getElementById("wind_template");\r\n      windtemp.style.display = "block";\r\n      windtemp.childNodes[1].setAttribute("id", "monster_form");\r\n      document.getElementById("fire_template").style.display = "none";\r\n      document\r\n        .getElementById("fire_template")\r\n        .childNodes[1].removeAttribute("id");\r\n      document.getElementById("water_template").style.display = "none";\r\n      document\r\n        .getElementById("water_template")\r\n        .childNodes[1].removeAttribute("id");\r\n      document.getElementById("earth_template").style.display = "none";\r\n      document\r\n        .getElementById("earth_template")\r\n        .childNodes[1].removeAttribute("id");\r\n    });\r\n\r\n    this.radio_wind.addEventListener("click", this.updateForm);\r\n  }\r\n}\r\n\n// CONCATENATED MODULE: ./src/view/MapView.js\nclass MapView {\r\n  constructor(zoocontroller, weathercontroller) {\r\n    this.map = document.getElementById("map");\r\n    this.remove = document.getElementById("remove");\r\n\r\n    this.zoocontroller = zoocontroller;\r\n    this.weathercontroller = weathercontroller;\r\n\r\n    // Zoo width (zw) and zoo height (zh)\r\n\r\n    this.zw = 10;\r\n    this.zh = 10;\r\n\r\n    // Load buttons from index.html\r\n\r\n    let jungle = document.getElementById("jungle");\r\n    let desert = document.getElementById("desert");\r\n    let northpole = document.getElementById("northpole");\r\n\r\n    jungle.disabled = true;\r\n    jungle.setAttribute("class", "nes-btn is-disabled");\r\n\r\n    // ---------------------------------------------------------------------------------------------------------\r\n    // Buttons for switching between environments\r\n    // ---------------------------------------------------------------------------------------------------------\r\n\r\n    jungle.addEventListener("click", () => {\r\n      if (jungle.disabled != true) {\r\n        this.loadGrid(0);\r\n        jungle.disabled = true;\r\n        desert.disabled = false;\r\n        northpole.disabled = false;\r\n\r\n        jungle.setAttribute("class", "nes-btn is-disabled");\r\n        desert.setAttribute("class", "nes-btn is-warning");\r\n        northpole.setAttribute("class", "nes-btn");\r\n      }\r\n    });\r\n\r\n    desert.addEventListener("click", () => {\r\n      if (desert.disabled != true) {\r\n        this.loadGrid(2);\r\n        desert.disabled = true;\r\n        jungle.disabled = false;\r\n        northpole.disabled = false;\r\n\r\n        desert.setAttribute("class", "nes-btn is-disabled");\r\n        jungle.setAttribute("class", "nes-btn is-success");\r\n        northpole.setAttribute("class", "nes-btn");\r\n      }\r\n    });\r\n\r\n    northpole.addEventListener("click", () => {\r\n      if (northpole.disabled != true) {\r\n        this.loadGrid(1);\r\n        northpole.disabled = true;\r\n        desert.disabled = false;\r\n        jungle.disabled = false;\r\n\r\n        northpole.setAttribute("class", "nes-btn is-disabled");\r\n        jungle.setAttribute("class", "nes-btn is-success");\r\n        desert.setAttribute("class", "nes-btn is-warning");\r\n      }\r\n    });\r\n\r\n    // ---------------------------------------------------------------------------------------------------------\r\n\r\n    // Initialise the map from jungle\r\n    this.loadGrid(0);\r\n  }\r\n\r\n  loadGrid(terrain) {\r\n    // Terrain index: 0 is jungle, 1 is northpole, 3 is desert\r\n    this.terrain = terrain;\r\n    this.zoocontroller.loadGrid(this);\r\n  }\r\n\r\n  paintGrid(grid) {\r\n    this.grid = grid;\r\n    this.selected = this.grid[this.terrain].grid;\r\n    this.weathercontroller.updateWeather(this.grid[this.terrain].reference_city);\r\n    this.initRemove();\r\n    this.drawBoard();\r\n  }\r\n\r\n  drawBoard() {\r\n    let oldBoard = document.getElementById("grid");\r\n    if (oldBoard != null) {\r\n      oldBoard.remove();\r\n    }\r\n\r\n    this.table = document.createElement("table");\r\n    this.table.setAttribute("id", "grid");\r\n\r\n    for (let i = 0; i < this.zw; i++) {\r\n      this.tr = document.createElement("tr");\r\n      for (let y = 0; y < this.zh; y++) {\r\n        this.td = document.createElement("td");\r\n\r\n        // Drag and drop events\r\n        this.td.addEventListener("dragover", function(e) {\r\n          e.preventDefault();\r\n        });\r\n\r\n        this.td.addEventListener("dragenter", function(e) {\r\n          e.preventDefault();\r\n        });\r\n\r\n        let grid = this.grid;\r\n        let terrain = this.terrain;\r\n        let zoocontroller = this.zoocontroller;\r\n\r\n        this.td.addEventListener("drop", function(e) {\r\n          let data = e.dataTransfer.getData("Text");\r\n          let monster = document.getElementById(data);\r\n\r\n          if(monster != null) {\r\n            if (\r\n              !this.hasChildNodes() &&\r\n              monster.getAttribute("draggable") === "true"\r\n            ) {\r\n              let origin = monster.getAttribute("id").split("x");\r\n              let coordid = this.getAttribute("id").split("-");\r\n  \r\n              zoocontroller.addMonsterToGrid(grid, terrain, coordid[0], coordid[1]);\r\n  \r\n              if (monster.getAttribute("id") !== "-1x-1") {\r\n                zoocontroller.deleteMonsterFromGrid(grid, terrain, origin[0], origin[1]);\r\n              }\r\n  \r\n              monster.setAttribute("id", coordid[0] + "x" + coordid[1]);\r\n              this.append(monster);\r\n            }\r\n          }\r\n        });\r\n\r\n        this.td.setAttribute("id", i + "-" + y);\r\n\r\n        if (typeof this.selected[i].Columns[y] === "object") {\r\n          this.img = document.createElement("img");\r\n          this.img.setAttribute("class", "monster");\r\n\r\n          //Every monster gets an id based on their coordinates\r\n          this.img.setAttribute("id", i + "x" + y);\r\n          this.img.src = "../src/Resources/orangemonster.png";\r\n\r\n          this.img.draggable = true;\r\n          this.img.addEventListener("dragstart", function(e) {\r\n            e.dataTransfer.setData("Text", e.target.id);\r\n          });\r\n          this.td.appendChild(this.img);\r\n        }\r\n\r\n        if (this.selected[i].Columns[y] == 1) {\r\n          this.img = document.createElement("img");\r\n          this.img.setAttribute("class", "stone");\r\n\r\n          //Every monster gets an id based on their coordinates\r\n          this.img.setAttribute("id", i + "x" + y);\r\n\r\n          switch (terrain) {\r\n            // Jungle\r\n            case 0:\r\n              this.img.src = "../src/Resources/junglerock.png";\r\n              document.getElementById("map").style.backgroundColor = "#289150";\r\n              break;\r\n\r\n            // Nortpole\r\n            case 1:\r\n              this.img.src = "../src/Resources/icechunk.png";\r\n              document.getElementById("map").style.backgroundColor = "#D8FFFF";\r\n              break;\r\n\r\n            // Desert\r\n            case 2:\r\n              this.img.src = "../src/Resources/cactus.png";\r\n              document.getElementById("map").style.backgroundColor = "#EDC9AF";\r\n              break;\r\n\r\n            default:\r\n              break;\r\n          }\r\n          this.td.appendChild(this.img);\r\n        }\r\n        this.tr.appendChild(this.td);\r\n      }\r\n      this.table.appendChild(this.tr);\r\n    }\r\n    this.map.appendChild(this.table);\r\n  }\r\n\r\n  initRemove() {\r\n    let grid = this.grid;\r\n    let terrain = this.terrain;\r\n    let zoocontroller = this.zoocontroller;\r\n\r\n    this.remove.addEventListener("drop", function(e) {\r\n      let data = e.dataTransfer.getData("Text");\r\n      let monster = document.getElementById(data);\r\n      if(monster != null) {\r\n        let origin = monster.getAttribute("id").split("x");\r\n\r\n        zoocontroller.deleteMonsterFromGrid(grid, terrain, origin[0], origin[1]);\r\n\r\n        monster.remove();\r\n      }\r\n    });\r\n\r\n    this.remove.addEventListener("dragover", function(e) {\r\n      e.preventDefault();\r\n    });\r\n\r\n    this.remove.addEventListener("dragenter", function(e) {\r\n      e.preventDefault();\r\n    });\r\n  }\r\n}\r\n\n// CONCATENATED MODULE: ./src/Model/WeatherDataService.js\nclass WeatherDataService {\r\n\r\n    constructor() {\r\n        this.apikey = \'6efc35c3c2611e414ea66da76b2e3f0b\';\r\n        this.units = \'metric\';\r\n    }\r\n\r\n    getCurrentWeather(cityName) {\r\n        return fetch(`http://api.openweathermap.org/data/2.5/weather?q=${cityName}&appid=${this.apikey}&units=${this.units}`)\r\n        .then(function(response) {\r\n          return response.json();\r\n        })\r\n        .then(function(myJson) {\r\n          return myJson;\r\n        });\r\n      }\r\n}\n// CONCATENATED MODULE: ./src/View/WeatherView.js\nclass WeatherView {\r\n\r\n    constructor() {\r\n        this.img = document.getElementById(\'weatherimg\');\r\n        this.temp = document.getElementById(\'temp\');\r\n    }\r\n\r\n    updateWeather(temp) {\r\n        this.temp.innerText = `${temp}° Celcius`;\r\n    }\r\n}\n// CONCATENATED MODULE: ./src/Controller/WeatherController.js\n\r\n\r\n\r\nclass WeatherController_WeatherController {\r\n    constructor() {\r\n        this.weatherdata = new WeatherDataService();\r\n        this.weatherview = new WeatherView();\r\n    }\r\n\r\n    updateWeather(city) {\r\n        let weatherview = this.weatherview;\r\n        this.weatherdata.getCurrentWeather(city).then(function(data) {\r\n            weatherview.updateWeather(data.main.temp);\r\n        });\r\n    }\r\n}\n// CONCATENATED MODULE: ./src/Model/MapService.js\nclass MapService {\r\n  loadGrid() {\r\n    return fetch("./map/grid.json")\r\n      .then(function(response) {\r\n        return response.json();\r\n      })\r\n      .then(function(grid) {\r\n        let STORAGE_KEY = "zoo-grid";\r\n\r\n        // Put the whole grid from localstorage in a variable\r\n        let storage = JSON.parse(localStorage.getItem(STORAGE_KEY));\r\n\r\n        if (storage != null) {\r\n          grid = storage;\r\n\r\n        // If the grid is not present in localstorage yet, put the whole grid as loaded from the local grid.json file in there\r\n        } else {\r\n          localStorage.setItem(STORAGE_KEY, JSON.stringify(grid));\r\n        }\r\n\r\n        return grid;\r\n      });\r\n  }\r\n\r\n  addMonsterToGrid(grid, terrain, monster, x, y) {\r\n    grid[terrain].grid[x].Columns[y] = monster;\r\n    this.saveToLocalStorage(grid);\r\n  }\r\n\r\n  deleteMonsterFromGrid(grid, terrain, x, y) {\r\n    grid[terrain].grid[x].Columns[y] = "0";\r\n    this.saveToLocalStorage(grid);\r\n  }\r\n\r\n  saveToLocalStorage(grid) {\r\n    let STORAGE_KEY = "zoo-grid";\r\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(grid));\r\n  }\r\n\r\n}\r\n\n// CONCATENATED MODULE: ./src/Controller/ZooController.js\n\r\n\r\n\r\n\r\n\r\n\r\nclass ZooController_ZooController\r\n{\r\n    //el constructor\r\n    constructor(){\r\n        this.weathercontroller = new WeatherController_WeatherController();\r\n\r\n        this.monsterservice = new MonsterService_MonsterService();\r\n        this.createmonsterview =  new CreateMonsterView(this);\r\n        this.mapservice = new MapService();\r\n\r\n        this.mapview = new MapView(this, this.weathercontroller);\r\n    }\r\n\r\n    addMonsterToGrid(grid, terrain, x, y) {\r\n        this.mapservice.addMonsterToGrid(grid, terrain, this.getLastMonster(), x, y);\r\n    }\r\n\r\n    deleteMonsterFromGrid(grid, terrain, x, y) {\r\n        this.mapservice.deleteMonsterFromGrid(grid, terrain, x, y);\r\n    }\r\n\r\n    addMonster(data){\r\n        let newMonster = new Monster(data);\r\n        this.monsterservice.saveMonster(newMonster);\r\n    }\r\n\r\n    loadGrid(mapview) {\r\n        this.mapservice.loadGrid().then(function(grid) {\r\n            mapview.paintGrid(grid);\r\n        });\r\n    }\r\n\r\n    getLastMonster() {\r\n        return this.monsterservice.getLastMonster();\r\n    }\r\n}\n// CONCATENATED MODULE: ./src/app.js\n\r\n\r\nlet zoocontroller = new ZooController_ZooController();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvbW9kZWwvTW9uc3Rlci5qcz81MThkIiwid2VicGFjazovLy8uL3NyYy9tb2RlbC9Nb25zdGVyU2VydmljZS5qcz8wODkyIiwid2VicGFjazovLy8uL3NyYy92aWV3L0NyZWF0ZU1vbnN0ZXJWaWV3LmpzP2M3NzAiLCJ3ZWJwYWNrOi8vLy4vc3JjL3ZpZXcvTWFwVmlldy5qcz8wOTQ4Iiwid2VicGFjazovLy8uL3NyYy9Nb2RlbC9XZWF0aGVyRGF0YVNlcnZpY2UuanM/ZmM4ZSIsIndlYnBhY2s6Ly8vLi9zcmMvVmlldy9XZWF0aGVyVmlldy5qcz84NjFjIiwid2VicGFjazovLy8uL3NyYy9Db250cm9sbGVyL1dlYXRoZXJDb250cm9sbGVyLmpzPzE1ZjQiLCJ3ZWJwYWNrOi8vLy4vc3JjL01vZGVsL01hcFNlcnZpY2UuanM/MjA4MiIsIndlYnBhY2s6Ly8vLi9zcmMvQ29udHJvbGxlci9ab29Db250cm9sbGVyLmpzP2JjZDkiLCJ3ZWJwYWNrOi8vLy4vc3JjL2FwcC5qcz8xMTEyIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFPLE1BQU0sZUFBTztBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBLEk7O0FDbEJvQzs7O0FBRzdCLE1BQU0sNkJBQWM7QUFDM0I7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGVBQU87QUFDdkI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7OztBQ3ZCTzs7QUFFUDtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQOztBQUVBOztBQUVBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7OztBQ25KTztBQUNQO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxtQkFBbUIsYUFBYTtBQUNoQztBQUNBLHFCQUFxQixhQUFhO0FBQ2xDOztBQUVBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBLFNBQVM7O0FBRVQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTOztBQUVUOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBOzs7QUN4Tk87O0FBRVA7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSx5RUFBeUUsU0FBUyxTQUFTLFlBQVksU0FBUyxXQUFXO0FBQzNIO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEM7O0FDaEJPOztBQUVQO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsaUNBQWlDLEtBQUs7QUFDdEM7QUFDQSxDOztBQ1ZpRTtBQUNmOztBQUUzQyxNQUFNLG1DQUFpQjtBQUM5QjtBQUNBLCtCQUErQixrQkFBa0I7QUFDakQsK0JBQStCLFdBQVc7QUFDMUM7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxDOztBQ2ZPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBLE9BQU87QUFDUDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7O0FDdkN3RDtBQUNNO0FBQ3BCO0FBQ2M7QUFDUDs7QUFFbEMsTUFBTSwyQkFBYTtBQUNsQztBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsbUNBQWlCOztBQUV0RCxrQ0FBa0MsNkJBQWM7QUFDaEQsc0NBQXNDLGlCQUFpQjtBQUN2RCw4QkFBOEIsVUFBVTs7QUFFeEMsMkJBQTJCLE9BQU87QUFDbEM7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsQzs7QUN6Q3VEOztBQUV2RCx3QkFBd0IsMkJBQWEiLCJmaWxlIjoiMC5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBNb25zdGVye1xyXG4gICAgLy8gTW9uc3RlckRhdGEgZXhpc3RzIG9mIGVsZW1lbnQsIG5hbWUsIGFybXMsIHR5cGVfYXJtcywgbGVncywgZXllcywgc2tpbnR5cGUsIGFiaWxpdHkgdG8gZmx5LCBhYmlsaXR5IHRvIHN3aW0sIGNvbG91ciAsbWFwLCB4IGNvb3JkaW5hdGUsIHkgY29vcmRpbmF0ZVxyXG4gICAgY29uc3RydWN0b3IobW9uc3RlcmRhdGEpe1xyXG4gICAgICAgIE9iamVjdC5hc3NpZ24odGhpcywgbW9uc3RlcmRhdGEpO1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyBjbGFzcyBmaXJlTW9uc3RlciBleHRlbmRzIE1vbnN0ZXJ7XHJcblxyXG4vLyB9XHJcbi8vIGNsYXNzIHdhdGVyZmlyZU1vbnN0ZXIgZXh0ZW5kcyBNb25zdGVye1xyXG4gICAgXHJcbi8vIH1cclxuLy8gY2xhc3MgZWFydGhNb25zdGVyIGV4dGVuZHMgTW9uc3RlcntcclxuICAgIFxyXG4vLyB9XHJcbi8vIGNsYXNzIHdpbmRNb25zdGVyIGV4dGVuZHMgTW9uc3RlcntcclxuICAgIFxyXG4vLyB9IiwiaW1wb3J0IHsgTW9uc3RlciB9IGZyb20gJy4vTW9uc3Rlcic7XHJcblxyXG5cclxuZXhwb3J0IGNsYXNzIE1vbnN0ZXJTZXJ2aWNlXHJcbntcclxuICAgIGNvbnN0cnVjdG9yKCl7XHJcbiAgICAgICAgdGhpcy5tb25zdGVycyA9IFtcclxuICAgICAgICAgICAgbmV3IE1vbnN0ZXIoJ2ZpcmUnLCAnTWFyaWpuJywgMiwgJ3RlbnRhY2xlcycsIDIsIDQsICdzY2FsZXMnLCBmYWxzZSwgZmFsc2UsICdvcmFuZ2UnLCAwLCAxLCAxKVxyXG4gICAgICAgIF1cclxuICAgIH1cclxuXHJcbiAgICBnZXRNb25zdGVycygpXHJcbiAgICB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubW9uc3RlcnM7XHJcbiAgICB9XHJcblxyXG4gICAgc2F2ZU1vbnN0ZXIobW9uc3Rlcil7XHJcbiAgICAgICB0aGlzLm1vbnN0ZXJzLnB1c2gobW9uc3Rlcik7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0TGFzdE1vbnN0ZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubW9uc3RlcnNbdGhpcy5tb25zdGVycy5sZW5ndGggLTFdO1xyXG4gICAgfVxyXG59XHJcbiIsImV4cG9ydCBjbGFzcyBDcmVhdGVNb25zdGVyVmlldyB7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGNvbnRyb2xsZXIpIHtcclxuICAgIHRoaXMuY29udHJvbGxlciA9IGNvbnRyb2xsZXI7XHJcblxyXG4gICAgdGhpcy50ZW1wbGF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY3JlYXRlX21vbnN0ZXJcIik7XHJcblxyXG4gICAgdGhpcy5yYWRpb19maXJlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJlbGVtZW50X2ZpcmVcIik7XHJcbiAgICB0aGlzLnJhZGlvX3dhdGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJlbGVtZW50X3dhdGVyXCIpO1xyXG4gICAgdGhpcy5yYWRpb19lYXJ0aCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZWxlbWVudF9lYXJ0aFwiKTtcclxuICAgIHRoaXMucmFkaW9fd2luZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZWxlbWVudF93aW5kXCIpO1xyXG4gICAgdGhpcy5yZW1vdmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJlbW92ZVwiKTtcclxuXHJcbiAgICB0aGlzLnNldEV2ZW50cygpO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlRm9ybSgpIHtcclxuICAgIHRoaXMubW9uc3RlcmZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1vbnN0ZXJfZm9ybVwiKTtcclxuICAgIGxldCBjcmVhdGVkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjcmVhdGVkXCIpO1xyXG5cclxuICAgIHRoaXMubW9uc3RlcmZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgIGlmIChjcmVhdGVkLmhhc0NoaWxkTm9kZXMoKSkge1xyXG4gICAgICAgIHdoaWxlIChjcmVhdGVkLmZpcnN0Q2hpbGQpIHtcclxuICAgICAgICAgIGNyZWF0ZWQucmVtb3ZlQ2hpbGQoY3JlYXRlZC5maXJzdENoaWxkKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5pbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW1nXCIpO1xyXG4gICAgICB0aGlzLmltZy5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBcImNyZWF0ZWRcIik7XHJcblxyXG4gICAgICBsZXQgc3JjID0gXCJcIjtcclxuXHJcbiAgICAgIHN3aXRjaCAodGhpcy5lbGVtZW50LnZhbHVlKSB7XHJcbiAgICAgICAgY2FzZSBcImZpcmVcIjpcclxuICAgICAgICAgIHNyYyA9IFwiLi4vc3JjL1Jlc291cmNlcy9vcmFuZ2Vtb25zdGVyLnBuZ1wiO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBcIndhdGVyXCI6XHJcbiAgICAgICAgICBzcmMgPSBcIi4uL3NyYy9SZXNvdXJjZXMvYmx1ZW1vbnN0ZXIucG5nXCI7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIFwiZWFydGhcIjpcclxuICAgICAgICAgIHNyYyA9IFwiLi4vc3JjL1Jlc291cmNlcy9icm93bm1vbnN0ZXIucG5nXCI7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIFwid2luZFwiOlxyXG4gICAgICAgICAgc3JjID0gXCIuLi9zcmMvUmVzb3VyY2VzL3doaXRlbW9uc3Rlci5wbmdcIjtcclxuICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5pbWcuc3JjID0gc3JjO1xyXG4gICAgICB0aGlzLmltZy5kcmFnZ2FibGUgPSB0cnVlO1xyXG4gICAgICB0aGlzLmltZy5zZXRBdHRyaWJ1dGUoJ2lkJywgJy0xeC0xJyk7XHJcbiAgICAgIHRoaXMuaW1nLmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnc3RhcnRcIiwgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgIGUuZGF0YVRyYW5zZmVyLnNldERhdGEoXCJUZXh0XCIsIGUudGFyZ2V0LmlkKTtcclxuICAgICAgfSk7XHJcbiAgICAgIGNyZWF0ZWQuYXBwZW5kQ2hpbGQodGhpcy5pbWcpO1xyXG5cclxuICAgICAgY29udHJvbGxlci5hZGRNb25zdGVyKHRoaXMubmFtZS52YWx1ZSwgdGhpcy5lbGVtZW50LnZhbHVlLCB0aGlzLmFybXMudmFsdWUsIHRoaXMudGVudGFjbGVzLnZhbHVlLCB0aGlzLmxlZ3MudmFsdWUsIHRoaXMuZXllcy52YWx1ZSwgdGhpcy5zd2ltdHlwZS52YWx1ZSwgdGhpcy5mbHkudmFsdWUsIHRoaXMuc3dpbS52YWx1ZSwgdGhpcy5jb2xvdXIudmFsdWUsIHRoaXMubWFwLnZhbHVlLCB0aGlzLngudmFsdWUsIHRoaXMueS52YWx1ZSk7XHJcblxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudHMoKSB7XHJcbiAgICAvL2V2ZW50c1xyXG4gICAgdGhpcy5yYWRpb19maXJlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbigpIHtcclxuICAgICAgaWYgKHRoaXMuY2hlY2tlZCkge1xyXG4gICAgICAgIGxldCBmaXJldGVtcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZmlyZV90ZW1wbGF0ZVwiKTtcclxuICAgICAgICBmaXJldGVtcC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG4gICAgICAgIGZpcmV0ZW1wLmNoaWxkTm9kZXNbMV0uc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJtb25zdGVyX2Zvcm1cIik7XHJcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ3YXRlcl90ZW1wbGF0ZVwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgICAgZG9jdW1lbnRcclxuICAgICAgICAgIC5nZXRFbGVtZW50QnlJZChcIndhdGVyX3RlbXBsYXRlXCIpXHJcbiAgICAgICAgICAuY2hpbGROb2Rlc1sxXS5yZW1vdmVBdHRyaWJ1dGUoXCJpZFwiKTtcclxuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVhcnRoX3RlbXBsYXRlXCIpLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgICAgICBkb2N1bWVudFxyXG4gICAgICAgICAgLmdldEVsZW1lbnRCeUlkKFwiZWFydGhfdGVtcGxhdGVcIilcclxuICAgICAgICAgIC5jaGlsZE5vZGVzWzFdLnJlbW92ZUF0dHJpYnV0ZShcImlkXCIpO1xyXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwid2luZF90ZW1wbGF0ZVwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgICAgZG9jdW1lbnRcclxuICAgICAgICAgIC5nZXRFbGVtZW50QnlJZChcIndpbmRfdGVtcGxhdGVcIilcclxuICAgICAgICAgIC5jaGlsZE5vZGVzWzFdLnJlbW92ZUF0dHJpYnV0ZShcImlkXCIpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLnJhZGlvX2ZpcmUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMudXBkYXRlRm9ybSk7XHJcblxyXG4gICAgdGhpcy5yYWRpb193YXRlci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgIGxldCB3YXRlcnRlbXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIndhdGVyX3RlbXBsYXRlXCIpO1xyXG4gICAgICB3YXRlcnRlbXAuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuICAgICAgd2F0ZXJ0ZW1wLmNoaWxkTm9kZXNbMV0uc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJtb25zdGVyX2Zvcm1cIik7XHJcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZmlyZV90ZW1wbGF0ZVwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgIGRvY3VtZW50XHJcbiAgICAgICAgLmdldEVsZW1lbnRCeUlkKFwiZmlyZV90ZW1wbGF0ZVwiKVxyXG4gICAgICAgIC5jaGlsZE5vZGVzWzFdLnJlbW92ZUF0dHJpYnV0ZShcImlkXCIpO1xyXG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVhcnRoX3RlbXBsYXRlXCIpLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgICAgZG9jdW1lbnRcclxuICAgICAgICAuZ2V0RWxlbWVudEJ5SWQoXCJlYXJ0aF90ZW1wbGF0ZVwiKVxyXG4gICAgICAgIC5jaGlsZE5vZGVzWzFdLnJlbW92ZUF0dHJpYnV0ZShcImlkXCIpO1xyXG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIndpbmRfdGVtcGxhdGVcIikuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgICBkb2N1bWVudFxyXG4gICAgICAgIC5nZXRFbGVtZW50QnlJZChcIndpbmRfdGVtcGxhdGVcIilcclxuICAgICAgICAuY2hpbGROb2Rlc1sxXS5yZW1vdmVBdHRyaWJ1dGUoXCJpZFwiKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMucmFkaW9fd2F0ZXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMudXBkYXRlRm9ybSk7XHJcblxyXG4gICAgdGhpcy5yYWRpb19lYXJ0aC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgIGxldCBlYXJ0aHRlbXAgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImVhcnRoX3RlbXBsYXRlXCIpO1xyXG4gICAgICBlYXJ0aHRlbXAuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuICAgICAgZWFydGh0ZW1wLmNoaWxkTm9kZXNbMV0uc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJtb25zdGVyX2Zvcm1cIik7XHJcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZmlyZV90ZW1wbGF0ZVwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgIGRvY3VtZW50XHJcbiAgICAgICAgLmdldEVsZW1lbnRCeUlkKFwiZmlyZV90ZW1wbGF0ZVwiKVxyXG4gICAgICAgIC5jaGlsZE5vZGVzWzFdLnJlbW92ZUF0dHJpYnV0ZShcImlkXCIpO1xyXG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIndhdGVyX3RlbXBsYXRlXCIpLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgICAgZG9jdW1lbnRcclxuICAgICAgICAuZ2V0RWxlbWVudEJ5SWQoXCJ3YXRlcl90ZW1wbGF0ZVwiKVxyXG4gICAgICAgIC5jaGlsZE5vZGVzWzFdLnJlbW92ZUF0dHJpYnV0ZShcImlkXCIpO1xyXG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIndpbmRfdGVtcGxhdGVcIikuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgICBkb2N1bWVudFxyXG4gICAgICAgIC5nZXRFbGVtZW50QnlJZChcIndpbmRfdGVtcGxhdGVcIilcclxuICAgICAgICAuY2hpbGROb2Rlc1sxXS5yZW1vdmVBdHRyaWJ1dGUoXCJpZFwiKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMucmFkaW9fZWFydGguYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMudXBkYXRlRm9ybSk7XHJcblxyXG4gICAgdGhpcy5yYWRpb193aW5kLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbigpIHtcclxuICAgICAgbGV0IHdpbmR0ZW1wID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ3aW5kX3RlbXBsYXRlXCIpO1xyXG4gICAgICB3aW5kdGVtcC5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG4gICAgICB3aW5kdGVtcC5jaGlsZE5vZGVzWzFdLnNldEF0dHJpYnV0ZShcImlkXCIsIFwibW9uc3Rlcl9mb3JtXCIpO1xyXG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImZpcmVfdGVtcGxhdGVcIikuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgICBkb2N1bWVudFxyXG4gICAgICAgIC5nZXRFbGVtZW50QnlJZChcImZpcmVfdGVtcGxhdGVcIilcclxuICAgICAgICAuY2hpbGROb2Rlc1sxXS5yZW1vdmVBdHRyaWJ1dGUoXCJpZFwiKTtcclxuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ3YXRlcl90ZW1wbGF0ZVwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgIGRvY3VtZW50XHJcbiAgICAgICAgLmdldEVsZW1lbnRCeUlkKFwid2F0ZXJfdGVtcGxhdGVcIilcclxuICAgICAgICAuY2hpbGROb2Rlc1sxXS5yZW1vdmVBdHRyaWJ1dGUoXCJpZFwiKTtcclxuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJlYXJ0aF90ZW1wbGF0ZVwiKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgIGRvY3VtZW50XHJcbiAgICAgICAgLmdldEVsZW1lbnRCeUlkKFwiZWFydGhfdGVtcGxhdGVcIilcclxuICAgICAgICAuY2hpbGROb2Rlc1sxXS5yZW1vdmVBdHRyaWJ1dGUoXCJpZFwiKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMucmFkaW9fd2luZC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy51cGRhdGVGb3JtKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGNsYXNzIE1hcFZpZXcge1xyXG4gIGNvbnN0cnVjdG9yKHpvb2NvbnRyb2xsZXIsIHdlYXRoZXJjb250cm9sbGVyKSB7XHJcbiAgICB0aGlzLm1hcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWFwXCIpO1xyXG4gICAgdGhpcy5yZW1vdmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJlbW92ZVwiKTtcclxuXHJcbiAgICB0aGlzLnpvb2NvbnRyb2xsZXIgPSB6b29jb250cm9sbGVyO1xyXG4gICAgdGhpcy53ZWF0aGVyY29udHJvbGxlciA9IHdlYXRoZXJjb250cm9sbGVyO1xyXG5cclxuICAgIC8vIFpvbyB3aWR0aCAoencpIGFuZCB6b28gaGVpZ2h0ICh6aClcclxuXHJcbiAgICB0aGlzLnp3ID0gMTA7XHJcbiAgICB0aGlzLnpoID0gMTA7XHJcblxyXG4gICAgLy8gTG9hZCBidXR0b25zIGZyb20gaW5kZXguaHRtbFxyXG5cclxuICAgIGxldCBqdW5nbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImp1bmdsZVwiKTtcclxuICAgIGxldCBkZXNlcnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImRlc2VydFwiKTtcclxuICAgIGxldCBub3J0aHBvbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5vcnRocG9sZVwiKTtcclxuXHJcbiAgICBqdW5nbGUuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAganVuZ2xlLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwibmVzLWJ0biBpcy1kaXNhYmxlZFwiKTtcclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIEJ1dHRvbnMgZm9yIHN3aXRjaGluZyBiZXR3ZWVuIGVudmlyb25tZW50c1xyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAganVuZ2xlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIGlmIChqdW5nbGUuZGlzYWJsZWQgIT0gdHJ1ZSkge1xyXG4gICAgICAgIHRoaXMubG9hZEdyaWQoMCk7XHJcbiAgICAgICAganVuZ2xlLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgICBkZXNlcnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICBub3J0aHBvbGUuZGlzYWJsZWQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAganVuZ2xlLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwibmVzLWJ0biBpcy1kaXNhYmxlZFwiKTtcclxuICAgICAgICBkZXNlcnQuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJuZXMtYnRuIGlzLXdhcm5pbmdcIik7XHJcbiAgICAgICAgbm9ydGhwb2xlLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwibmVzLWJ0blwiKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzZXJ0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIGlmIChkZXNlcnQuZGlzYWJsZWQgIT0gdHJ1ZSkge1xyXG4gICAgICAgIHRoaXMubG9hZEdyaWQoMik7XHJcbiAgICAgICAgZGVzZXJ0LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgICBqdW5nbGUuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICBub3J0aHBvbGUuZGlzYWJsZWQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgZGVzZXJ0LnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwibmVzLWJ0biBpcy1kaXNhYmxlZFwiKTtcclxuICAgICAgICBqdW5nbGUuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJuZXMtYnRuIGlzLXN1Y2Nlc3NcIik7XHJcbiAgICAgICAgbm9ydGhwb2xlLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwibmVzLWJ0blwiKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgbm9ydGhwb2xlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIGlmIChub3J0aHBvbGUuZGlzYWJsZWQgIT0gdHJ1ZSkge1xyXG4gICAgICAgIHRoaXMubG9hZEdyaWQoMSk7XHJcbiAgICAgICAgbm9ydGhwb2xlLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgICBkZXNlcnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICBqdW5nbGUuZGlzYWJsZWQgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgbm9ydGhwb2xlLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwibmVzLWJ0biBpcy1kaXNhYmxlZFwiKTtcclxuICAgICAgICBqdW5nbGUuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJuZXMtYnRuIGlzLXN1Y2Nlc3NcIik7XHJcbiAgICAgICAgZGVzZXJ0LnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIFwibmVzLWJ0biBpcy13YXJuaW5nXCIpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICAvLyBJbml0aWFsaXNlIHRoZSBtYXAgZnJvbSBqdW5nbGVcclxuICAgIHRoaXMubG9hZEdyaWQoMCk7XHJcbiAgfVxyXG5cclxuICBsb2FkR3JpZCh0ZXJyYWluKSB7XHJcbiAgICAvLyBUZXJyYWluIGluZGV4OiAwIGlzIGp1bmdsZSwgMSBpcyBub3J0aHBvbGUsIDMgaXMgZGVzZXJ0XHJcbiAgICB0aGlzLnRlcnJhaW4gPSB0ZXJyYWluO1xyXG4gICAgdGhpcy56b29jb250cm9sbGVyLmxvYWRHcmlkKHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgcGFpbnRHcmlkKGdyaWQpIHtcclxuICAgIHRoaXMuZ3JpZCA9IGdyaWQ7XHJcbiAgICB0aGlzLnNlbGVjdGVkID0gdGhpcy5ncmlkW3RoaXMudGVycmFpbl0uZ3JpZDtcclxuICAgIHRoaXMud2VhdGhlcmNvbnRyb2xsZXIudXBkYXRlV2VhdGhlcih0aGlzLmdyaWRbdGhpcy50ZXJyYWluXS5yZWZlcmVuY2VfY2l0eSk7XHJcbiAgICB0aGlzLmluaXRSZW1vdmUoKTtcclxuICAgIHRoaXMuZHJhd0JvYXJkKCk7XHJcbiAgfVxyXG5cclxuICBkcmF3Qm9hcmQoKSB7XHJcbiAgICBsZXQgb2xkQm9hcmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImdyaWRcIik7XHJcbiAgICBpZiAob2xkQm9hcmQgIT0gbnVsbCkge1xyXG4gICAgICBvbGRCb2FyZC5yZW1vdmUoKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLnRhYmxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRhYmxlXCIpO1xyXG4gICAgdGhpcy50YWJsZS5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBcImdyaWRcIik7XHJcblxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnp3OyBpKyspIHtcclxuICAgICAgdGhpcy50ciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0clwiKTtcclxuICAgICAgZm9yIChsZXQgeSA9IDA7IHkgPCB0aGlzLnpoOyB5KyspIHtcclxuICAgICAgICB0aGlzLnRkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRkXCIpO1xyXG5cclxuICAgICAgICAvLyBEcmFnIGFuZCBkcm9wIGV2ZW50c1xyXG4gICAgICAgIHRoaXMudGQuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdvdmVyXCIsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy50ZC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ2VudGVyXCIsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IGdyaWQgPSB0aGlzLmdyaWQ7XHJcbiAgICAgICAgbGV0IHRlcnJhaW4gPSB0aGlzLnRlcnJhaW47XHJcbiAgICAgICAgbGV0IHpvb2NvbnRyb2xsZXIgPSB0aGlzLnpvb2NvbnRyb2xsZXI7XHJcblxyXG4gICAgICAgIHRoaXMudGQuYWRkRXZlbnRMaXN0ZW5lcihcImRyb3BcIiwgZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgbGV0IGRhdGEgPSBlLmRhdGFUcmFuc2Zlci5nZXREYXRhKFwiVGV4dFwiKTtcclxuICAgICAgICAgIGxldCBtb25zdGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZGF0YSk7XHJcblxyXG4gICAgICAgICAgaWYobW9uc3RlciAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAhdGhpcy5oYXNDaGlsZE5vZGVzKCkgJiZcclxuICAgICAgICAgICAgICBtb25zdGVyLmdldEF0dHJpYnV0ZShcImRyYWdnYWJsZVwiKSA9PT0gXCJ0cnVlXCJcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgbGV0IG9yaWdpbiA9IG1vbnN0ZXIuZ2V0QXR0cmlidXRlKFwiaWRcIikuc3BsaXQoXCJ4XCIpO1xyXG4gICAgICAgICAgICAgIGxldCBjb29yZGlkID0gdGhpcy5nZXRBdHRyaWJ1dGUoXCJpZFwiKS5zcGxpdChcIi1cIik7XHJcbiAgXHJcbiAgICAgICAgICAgICAgem9vY29udHJvbGxlci5hZGRNb25zdGVyVG9HcmlkKGdyaWQsIHRlcnJhaW4sIGNvb3JkaWRbMF0sIGNvb3JkaWRbMV0pO1xyXG4gIFxyXG4gICAgICAgICAgICAgIGlmIChtb25zdGVyLmdldEF0dHJpYnV0ZShcImlkXCIpICE9PSBcIi0xeC0xXCIpIHtcclxuICAgICAgICAgICAgICAgIHpvb2NvbnRyb2xsZXIuZGVsZXRlTW9uc3RlckZyb21HcmlkKGdyaWQsIHRlcnJhaW4sIG9yaWdpblswXSwgb3JpZ2luWzFdKTtcclxuICAgICAgICAgICAgICB9XHJcbiAgXHJcbiAgICAgICAgICAgICAgbW9uc3Rlci5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBjb29yZGlkWzBdICsgXCJ4XCIgKyBjb29yZGlkWzFdKTtcclxuICAgICAgICAgICAgICB0aGlzLmFwcGVuZChtb25zdGVyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLnRkLnNldEF0dHJpYnV0ZShcImlkXCIsIGkgKyBcIi1cIiArIHkpO1xyXG5cclxuICAgICAgICBpZiAodHlwZW9mIHRoaXMuc2VsZWN0ZWRbaV0uQ29sdW1uc1t5XSA9PT0gXCJvYmplY3RcIikge1xyXG4gICAgICAgICAgdGhpcy5pbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW1nXCIpO1xyXG4gICAgICAgICAgdGhpcy5pbWcuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJtb25zdGVyXCIpO1xyXG5cclxuICAgICAgICAgIC8vRXZlcnkgbW9uc3RlciBnZXRzIGFuIGlkIGJhc2VkIG9uIHRoZWlyIGNvb3JkaW5hdGVzXHJcbiAgICAgICAgICB0aGlzLmltZy5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBpICsgXCJ4XCIgKyB5KTtcclxuICAgICAgICAgIHRoaXMuaW1nLnNyYyA9IFwiLi4vc3JjL1Jlc291cmNlcy9vcmFuZ2Vtb25zdGVyLnBuZ1wiO1xyXG5cclxuICAgICAgICAgIHRoaXMuaW1nLmRyYWdnYWJsZSA9IHRydWU7XHJcbiAgICAgICAgICB0aGlzLmltZy5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ3N0YXJ0XCIsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgZS5kYXRhVHJhbnNmZXIuc2V0RGF0YShcIlRleHRcIiwgZS50YXJnZXQuaWQpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICB0aGlzLnRkLmFwcGVuZENoaWxkKHRoaXMuaW1nKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGVkW2ldLkNvbHVtbnNbeV0gPT0gMSkge1xyXG4gICAgICAgICAgdGhpcy5pbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW1nXCIpO1xyXG4gICAgICAgICAgdGhpcy5pbWcuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJzdG9uZVwiKTtcclxuXHJcbiAgICAgICAgICAvL0V2ZXJ5IG1vbnN0ZXIgZ2V0cyBhbiBpZCBiYXNlZCBvbiB0aGVpciBjb29yZGluYXRlc1xyXG4gICAgICAgICAgdGhpcy5pbWcuc2V0QXR0cmlidXRlKFwiaWRcIiwgaSArIFwieFwiICsgeSk7XHJcblxyXG4gICAgICAgICAgc3dpdGNoICh0ZXJyYWluKSB7XHJcbiAgICAgICAgICAgIC8vIEp1bmdsZVxyXG4gICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgdGhpcy5pbWcuc3JjID0gXCIuLi9zcmMvUmVzb3VyY2VzL2p1bmdsZXJvY2sucG5nXCI7XHJcbiAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtYXBcIikuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gXCIjMjg5MTUwXCI7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAvLyBOb3J0cG9sZVxyXG4gICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgdGhpcy5pbWcuc3JjID0gXCIuLi9zcmMvUmVzb3VyY2VzL2ljZWNodW5rLnBuZ1wiO1xyXG4gICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWFwXCIpLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiI0Q4RkZGRlwiO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgLy8gRGVzZXJ0XHJcbiAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICB0aGlzLmltZy5zcmMgPSBcIi4uL3NyYy9SZXNvdXJjZXMvY2FjdHVzLnBuZ1wiO1xyXG4gICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWFwXCIpLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiI0VEQzlBRlwiO1xyXG4gICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHRoaXMudGQuYXBwZW5kQ2hpbGQodGhpcy5pbWcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnRyLmFwcGVuZENoaWxkKHRoaXMudGQpO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMudGFibGUuYXBwZW5kQ2hpbGQodGhpcy50cik7XHJcbiAgICB9XHJcbiAgICB0aGlzLm1hcC5hcHBlbmRDaGlsZCh0aGlzLnRhYmxlKTtcclxuICB9XHJcblxyXG4gIGluaXRSZW1vdmUoKSB7XHJcbiAgICBsZXQgZ3JpZCA9IHRoaXMuZ3JpZDtcclxuICAgIGxldCB0ZXJyYWluID0gdGhpcy50ZXJyYWluO1xyXG4gICAgbGV0IHpvb2NvbnRyb2xsZXIgPSB0aGlzLnpvb2NvbnRyb2xsZXI7XHJcblxyXG4gICAgdGhpcy5yZW1vdmUuYWRkRXZlbnRMaXN0ZW5lcihcImRyb3BcIiwgZnVuY3Rpb24oZSkge1xyXG4gICAgICBsZXQgZGF0YSA9IGUuZGF0YVRyYW5zZmVyLmdldERhdGEoXCJUZXh0XCIpO1xyXG4gICAgICBsZXQgbW9uc3RlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGRhdGEpO1xyXG4gICAgICBpZihtb25zdGVyICE9IG51bGwpIHtcclxuICAgICAgICBsZXQgb3JpZ2luID0gbW9uc3Rlci5nZXRBdHRyaWJ1dGUoXCJpZFwiKS5zcGxpdChcInhcIik7XHJcblxyXG4gICAgICAgIHpvb2NvbnRyb2xsZXIuZGVsZXRlTW9uc3RlckZyb21HcmlkKGdyaWQsIHRlcnJhaW4sIG9yaWdpblswXSwgb3JpZ2luWzFdKTtcclxuXHJcbiAgICAgICAgbW9uc3Rlci5yZW1vdmUoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5yZW1vdmUuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdvdmVyXCIsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5yZW1vdmUuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdlbnRlclwiLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY2xhc3MgV2VhdGhlckRhdGFTZXJ2aWNlIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLmFwaWtleSA9ICc2ZWZjMzVjM2MyNjExZTQxNGVhNjZkYTc2YjJlM2YwYic7XHJcbiAgICAgICAgdGhpcy51bml0cyA9ICdtZXRyaWMnO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEN1cnJlbnRXZWF0aGVyKGNpdHlOYW1lKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGBodHRwOi8vYXBpLm9wZW53ZWF0aGVybWFwLm9yZy9kYXRhLzIuNS93ZWF0aGVyP3E9JHtjaXR5TmFtZX0mYXBwaWQ9JHt0aGlzLmFwaWtleX0mdW5pdHM9JHt0aGlzLnVuaXRzfWApXHJcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAudGhlbihmdW5jdGlvbihteUpzb24pIHtcclxuICAgICAgICAgIHJldHVybiBteUpzb247XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxufSIsImV4cG9ydCBjbGFzcyBXZWF0aGVyVmlldyB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5pbWcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2VhdGhlcmltZycpO1xyXG4gICAgICAgIHRoaXMudGVtcCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0ZW1wJyk7XHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlV2VhdGhlcih0ZW1wKSB7XHJcbiAgICAgICAgdGhpcy50ZW1wLmlubmVyVGV4dCA9IGAke3RlbXB9wrAgQ2VsY2l1c2A7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBXZWF0aGVyRGF0YVNlcnZpY2UgfSBmcm9tIFwiLi4vTW9kZWwvV2VhdGhlckRhdGFTZXJ2aWNlXCI7XHJcbmltcG9ydCB7IFdlYXRoZXJWaWV3IH0gZnJvbSBcIi4uL1ZpZXcvV2VhdGhlclZpZXdcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBXZWF0aGVyQ29udHJvbGxlciB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLndlYXRoZXJkYXRhID0gbmV3IFdlYXRoZXJEYXRhU2VydmljZSgpO1xyXG4gICAgICAgIHRoaXMud2VhdGhlcnZpZXcgPSBuZXcgV2VhdGhlclZpZXcoKTtcclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVXZWF0aGVyKGNpdHkpIHtcclxuICAgICAgICBsZXQgd2VhdGhlcnZpZXcgPSB0aGlzLndlYXRoZXJ2aWV3O1xyXG4gICAgICAgIHRoaXMud2VhdGhlcmRhdGEuZ2V0Q3VycmVudFdlYXRoZXIoY2l0eSkudGhlbihmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgIHdlYXRoZXJ2aWV3LnVwZGF0ZVdlYXRoZXIoZGF0YS5tYWluLnRlbXApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IGNsYXNzIE1hcFNlcnZpY2Uge1xyXG4gIGxvYWRHcmlkKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKFwiLi9tYXAvZ3JpZC5qc29uXCIpXHJcbiAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcclxuICAgICAgfSlcclxuICAgICAgLnRoZW4oZnVuY3Rpb24oZ3JpZCkge1xyXG4gICAgICAgIGxldCBTVE9SQUdFX0tFWSA9IFwiem9vLWdyaWRcIjtcclxuXHJcbiAgICAgICAgLy8gUHV0IHRoZSB3aG9sZSBncmlkIGZyb20gbG9jYWxzdG9yYWdlIGluIGEgdmFyaWFibGVcclxuICAgICAgICBsZXQgc3RvcmFnZSA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oU1RPUkFHRV9LRVkpKTtcclxuXHJcbiAgICAgICAgaWYgKHN0b3JhZ2UgIT0gbnVsbCkge1xyXG4gICAgICAgICAgZ3JpZCA9IHN0b3JhZ2U7XHJcblxyXG4gICAgICAgIC8vIElmIHRoZSBncmlkIGlzIG5vdCBwcmVzZW50IGluIGxvY2Fsc3RvcmFnZSB5ZXQsIHB1dCB0aGUgd2hvbGUgZ3JpZCBhcyBsb2FkZWQgZnJvbSB0aGUgbG9jYWwgZ3JpZC5qc29uIGZpbGUgaW4gdGhlcmVcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oU1RPUkFHRV9LRVksIEpTT04uc3RyaW5naWZ5KGdyaWQpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBncmlkO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZE1vbnN0ZXJUb0dyaWQoZ3JpZCwgdGVycmFpbiwgbW9uc3RlciwgeCwgeSkge1xyXG4gICAgZ3JpZFt0ZXJyYWluXS5ncmlkW3hdLkNvbHVtbnNbeV0gPSBtb25zdGVyO1xyXG4gICAgdGhpcy5zYXZlVG9Mb2NhbFN0b3JhZ2UoZ3JpZCk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVNb25zdGVyRnJvbUdyaWQoZ3JpZCwgdGVycmFpbiwgeCwgeSkge1xyXG4gICAgZ3JpZFt0ZXJyYWluXS5ncmlkW3hdLkNvbHVtbnNbeV0gPSBcIjBcIjtcclxuICAgIHRoaXMuc2F2ZVRvTG9jYWxTdG9yYWdlKGdyaWQpO1xyXG4gIH1cclxuXHJcbiAgc2F2ZVRvTG9jYWxTdG9yYWdlKGdyaWQpIHtcclxuICAgIGxldCBTVE9SQUdFX0tFWSA9IFwiem9vLWdyaWRcIjtcclxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFNUT1JBR0VfS0VZLCBKU09OLnN0cmluZ2lmeShncmlkKSk7XHJcbiAgfVxyXG5cclxufVxyXG4iLCJpbXBvcnQgeyBNb25zdGVyU2VydmljZSB9IGZyb20gJy4uL21vZGVsL01vbnN0ZXJTZXJ2aWNlJ1xyXG5pbXBvcnQgeyBDcmVhdGVNb25zdGVyVmlldyB9IGZyb20gJy4uL3ZpZXcvQ3JlYXRlTW9uc3RlclZpZXcnO1xyXG5pbXBvcnQgeyBNYXBWaWV3IH0gZnJvbSAnLi4vdmlldy9NYXBWaWV3JztcclxuaW1wb3J0IHsgV2VhdGhlckNvbnRyb2xsZXIgfSBmcm9tICcuL1dlYXRoZXJDb250cm9sbGVyJztcclxuaW1wb3J0IHsgTWFwU2VydmljZSB9IGZyb20gJy4uL01vZGVsL01hcFNlcnZpY2UnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgWm9vQ29udHJvbGxlclxyXG57XHJcbiAgICAvL2VsIGNvbnN0cnVjdG9yXHJcbiAgICBjb25zdHJ1Y3Rvcigpe1xyXG4gICAgICAgIHRoaXMud2VhdGhlcmNvbnRyb2xsZXIgPSBuZXcgV2VhdGhlckNvbnRyb2xsZXIoKTtcclxuXHJcbiAgICAgICAgdGhpcy5tb25zdGVyc2VydmljZSA9IG5ldyBNb25zdGVyU2VydmljZSgpO1xyXG4gICAgICAgIHRoaXMuY3JlYXRlbW9uc3RlcnZpZXcgPSAgbmV3IENyZWF0ZU1vbnN0ZXJWaWV3KHRoaXMpO1xyXG4gICAgICAgIHRoaXMubWFwc2VydmljZSA9IG5ldyBNYXBTZXJ2aWNlKCk7XHJcblxyXG4gICAgICAgIHRoaXMubWFwdmlldyA9IG5ldyBNYXBWaWV3KHRoaXMsIHRoaXMud2VhdGhlcmNvbnRyb2xsZXIpO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZE1vbnN0ZXJUb0dyaWQoZ3JpZCwgdGVycmFpbiwgeCwgeSkge1xyXG4gICAgICAgIHRoaXMubWFwc2VydmljZS5hZGRNb25zdGVyVG9HcmlkKGdyaWQsIHRlcnJhaW4sIHRoaXMuZ2V0TGFzdE1vbnN0ZXIoKSwgeCwgeSk7XHJcbiAgICB9XHJcblxyXG4gICAgZGVsZXRlTW9uc3RlckZyb21HcmlkKGdyaWQsIHRlcnJhaW4sIHgsIHkpIHtcclxuICAgICAgICB0aGlzLm1hcHNlcnZpY2UuZGVsZXRlTW9uc3RlckZyb21HcmlkKGdyaWQsIHRlcnJhaW4sIHgsIHkpO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZE1vbnN0ZXIoZGF0YSl7XHJcbiAgICAgICAgbGV0IG5ld01vbnN0ZXIgPSBuZXcgTW9uc3RlcihkYXRhKTtcclxuICAgICAgICB0aGlzLm1vbnN0ZXJzZXJ2aWNlLnNhdmVNb25zdGVyKG5ld01vbnN0ZXIpO1xyXG4gICAgfVxyXG5cclxuICAgIGxvYWRHcmlkKG1hcHZpZXcpIHtcclxuICAgICAgICB0aGlzLm1hcHNlcnZpY2UubG9hZEdyaWQoKS50aGVuKGZ1bmN0aW9uKGdyaWQpIHtcclxuICAgICAgICAgICAgbWFwdmlldy5wYWludEdyaWQoZ3JpZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0TGFzdE1vbnN0ZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubW9uc3RlcnNlcnZpY2UuZ2V0TGFzdE1vbnN0ZXIoKTtcclxuICAgIH1cclxufSIsImltcG9ydCBab29Db250cm9sbGVyIGZyb20gJy4vQ29udHJvbGxlci9ab29Db250cm9sbGVyJztcclxuXHJcbmxldCB6b29jb250cm9sbGVyID0gbmV3IFpvb0NvbnRyb2xsZXIoKTsiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///0\n')}]);